<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>✨ Super Guides ✨ Blog</title>
        <link>https://talkohavy.github.io/guides/he/blog/</link>
        <description>✨ Super Guides ✨ Blog</description>
        <lastBuildDate>Sat, 10 Aug 2024 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>he</language>
        <item>
            <title><![CDATA[How to Create a Component Library with Vite]]></title>
            <link>https://talkohavy.github.io/guides/he/blog/vite-library-mode/</link>
            <guid>https://talkohavy.github.io/guides/he/blog/vite-library-mode/</guid>
            <pubDate>Sat, 10 Aug 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[How to create a components library fast using Vite's library mode, typescript, css modules, and publish to npm.]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithStickyNavbar_MJR6" id="1-set-up-a-new-vite-project">1. Set up a new Vite project<a class="hash-link" aria-label="קישור ישיר אל 1. Set up a new Vite project" title="קישור ישיר אל 1. Set up a new Vite project" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#1-set-up-a-new-vite-project">​</a></h2>
<p>Start a new project:</p>
<div class="language-bash codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-bash codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain">npm create vite@latest</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Choose <code>React</code> &amp; <code>TypeScript + SWC</code></p>
<p>Here are 4 things I recommend you to do right after installing Vite:</p>
<ol>
<li>
<p>Early first commit
Committing regularly is a very good habit. And there is one point in time where it is especially helpful, right after you created a new project and BEFORE you type the first character in your project.</p>
</li>
<li>
<p>Install node's types
If working with TypeScript I also install the types package for node. Sooner or later you will need this.</p>
<div class="language-bash codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-bash codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm add -D @types/node</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_MJR6" id="2-create-a-libmaints-file">2. Create a <code>lib/main.ts</code> file<a class="hash-link" aria-label="קישור ישיר אל 2-create-a-libmaints-file" title="קישור ישיר אל 2-create-a-libmaints-file" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#2-create-a-libmaints-file">​</a></h2>
<p>Create a folder next to <code>src</code> and name it <code>lib</code>. Inside, create the file which will act as the main entry point of your library, and name it <code>main.ts</code>. When installing the library you can import everything that is exported from this file.</p>
<div class="language-diff codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-diff codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain"> 📂 my-component-library</span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">┣ 📂 lib</span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">┃ ┗ 📜 main.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┣ 📂 public</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┣ 📂 src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  …</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_MJR6" id="3-activate-vites-library-mode">3. Activate Vite's Library Mode<a class="hash-link" aria-label="קישור ישיר אל 3. Activate Vite's Library Mode" title="קישור ישיר אל 3. Activate Vite's Library Mode" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#3-activate-vites-library-mode">​</a></h2>
<p>By default, when running <code>vite build</code>, Vite will transpile the code inside <code>src</code> to the <code>dist</code> folder. What we want instead, is to transpile and ship the code inside of <code>lib</code>.</p>
<p>To activate vite's library mode, inside of our <code>vite.config.ts</code> file, we will need to use the <code>build.lib</code> option.</p>
<p>Like so (do not copy code yet!):</p>
<div class="language-jsx codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-jsx codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX codeBlockLinesWithNumbering_MhpT"><span class="token-line custom-code-block-diff-add codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> resolve </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'path'</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> defineConfig </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'vite'</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports">react</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'@vitejs/plugin-react-swc'</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">default</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">defineConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">plugins</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token function" style="color:#d73a49">react</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line custom-code-block-diff-add codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">build</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line custom-code-block-diff-add codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">lib</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line custom-code-block-diff-add codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">entry</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__dirname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'lib/main.ts'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line custom-code-block-diff-add codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">formats</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'es'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><br></span><span class="token-line custom-code-block-diff-add codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><br></span><span class="token-line custom-code-block-diff-add codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_MJR6" id="4-tsconfigjson-dedicated-for-build">4. tsconfig.json dedicated for build<a class="hash-link" aria-label="קישור ישיר אל 4. tsconfig.json dedicated for build" title="קישור ישיר אל 4. tsconfig.json dedicated for build" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#4-tsconfigjson-dedicated-for-build">​</a></h2>
<p>Update the contents of your <code>tsconfig.json</code> file like so:</p>
<div class="language-json codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-json codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  "files": [],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  "references": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { "path": "./tsconfig.app.json" },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { "path": "./tsconfig.node.json" },</span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">    { "path": "./tsconfig.build.json" }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And create a new <code>tsconfig.json</code>:</p>
<div class="language-diff codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-diff codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain"> 📂my-component-library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┣ ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┣ 📜tsconfig.json</span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">┣ 📜tsconfig.build.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And paste the below code as its contents:</p>
<div class="language-json codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-json codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  "extends": "./tsconfig.json",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  "compilerOptions": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // -------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Section 1: Projects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // -------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "composite": true, // Enable constraints that allow a TypeScript project to be used with project references.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "incremental": true, // Save .tsbuildinfo files to allow for incremental compilation of projects.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.app.tsbuildinfo", // Specify the path to .tsbuildinfo incremental compilation file.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "disableSourceOfProjectReferenceRedirect": true,  // Disable preferring source files instead of declaration files when referencing composite projects.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "disableSolutionSearching": true,                 // Opt a project out of multi-project reference checking when editing.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "disableReferencedProjectLoad": true,             // Reduce the number of projects loaded automatically by TypeScript.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // -----------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Section 2: Language and Environment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // -----------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "target": "ESNext",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "jsx": "react-jsx", // Specify what JSX code is generated.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "lib": ["ESNext", "DOM", "DOM.Iterable"], // adding the "DOM" library helps vs-code to recognize the window &amp; document objects. Specify a set of bundled library declaration files that describe the target runtime environment.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "useDefineForClassFields": true, // Emit ECMAScript-standard-compliant class fields.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "moduleDetection": "force", // &lt;--- defaults to `auto`. Control what method is used to detect module-format JS files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "experimentalDecorators": true,                   // Enable experimental support for legacy experimental decorators.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "emitDecoratorMetadata": true,                    // Emit design-type metadata for decorated declarations in source files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "jsxFactory": "",                                 // Specify the JSX factory function used when targeting React JSX emit, e.g. 'React.createElement' or 'h'.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "jsxFragmentFactory": "",                         // Specify the JSX Fragment reference used for fragments when targeting React JSX emit e.g. 'React.Fragment' or 'Fragment'.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "jsxImportSource": "",                            // Specify module specifier used to import the JSX factory functions when using 'jsx: react-jsx*'.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "reactNamespace": "",                             // Specify the object invoked for 'createElement'. This only applies when targeting 'react' JSX emit.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "noLib": true,                                    // Disable including any library files, including the default lib.d.ts.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Section 3: Modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "module": "ESNext", // &lt;--- defaults to `commonjs`. Specify what module code is generated.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "moduleResolution": "Bundler", // Specify how TypeScript looks up a file from a given module specifier.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "resolveJsonModule": true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "allowImportingTsExtensions": true, // Option 'allowImportingTsExtensions' can only be used when either 'noEmit' or 'emitDeclarationOnly' is set.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "baseUrl": "./", // Specify the base directory to resolve non-relative module names.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "typeRoots": ["node_modules/@types"], // Specify multiple folders that act like './node_modules/@types'.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "paths": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "/*": ["src/public/*"],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "@src/*": ["src/*"]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "rootDirs": [],                                   /* Allow multiple folders to be treated as one when resolving modules. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "types": [],                                      /* Specify type package names to be included without being referenced in a source file. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "allowUmdGlobalAccess": true,                     /* Allow accessing UMD globals from modules. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "moduleSuffixes": [],                             /* List of file name suffixes to search when resolving a module. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "allowImportingTsExtensions": true,               /* Allow imports to include TypeScript file extensions. Requires '--moduleResolution bundler' and either '--noEmit' or '--emitDeclarationOnly' to be set. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "resolvePackageJsonExports": true,                /* Use the package.json 'exports' field when resolving package imports. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "resolvePackageJsonImports": true,                /* Use the package.json 'imports' field when resolving imports. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "customConditions": [],                           /* Conditions to set in addition to the resolver-specific defaults when resolving imports. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "resolveJsonModule": true,                        /* Enable importing .json files. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "allowArbitraryExtensions": true,                 /* Enable importing files with any extension, provided a declaration file is present. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "noResolve": true,                                /* Disallow 'import's, 'require's or '&lt;reference&gt;'s from expanding the number of files TypeScript should add to a project. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // -----------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Section 4: JavaScript Support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // -----------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "checkJs": true, // without it? this config file would not apply to js/jsx files. Enable error reporting in type-checked JavaScript files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "maxNodeModuleJsDepth": 0, // Specify the maximum folder depth used for checking JavaScript files from 'node_modules'. Only applicable with 'allowJs'.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "allowJs": true,                                  /* Allow JavaScript files to be a part of your program. Use the 'checkJS' option to get errors from these files. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ---------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Section 5: Emit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ---------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "noEmit": false, // set to `true` to disable emitting files from a compilation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "outDir": "./dist", // Specify an output folder for all emitted files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "declaration": true, // Generate .d.ts files from TypeScript and JavaScript files in your project.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "emitDeclarationOnly": true, // Only output d.ts files and not JavaScript files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "sourceMap": true, // defaults to `false`. Create source map files for emitted JavaScript files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "declarationMap": true, // Create sourcemaps for d.ts files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "inlineSourceMap": true, // Include sourcemap files inside the emitted JavaScript. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "outFile": "./", // Specify a file that bundles all outputs into one JavaScript file. If 'declaration' is true, also designates a file that bundles all .d.ts output. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "removeComments": true, // Disable emitting comments.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "importHelpers": true, // Allow importing helper functions from tslib once per project, instead of including them per-file.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "downlevelIteration": true, // Emit more compliant, but verbose and less performant JavaScript for iteration.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "sourceRoot": "", // Specify the root path for debuggers to find the reference source code.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "mapRoot": "", // Specify the location where debugger should locate map files instead of generated locations.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "inlineSources": true, // Include source code in the sourcemaps inside the emitted JavaScript.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "emitBOM": true, // Emit a UTF-8 Byte Order Mark (BOM) in the beginning of output files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "newLine": "crlf", // Set the newline character for emitting files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "stripInternal": true, // Disable emitting declarations that have '@internal' in their JSDoc comments.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "noEmitHelpers": true, // Disable generating custom helper functions like '__extends' in compiled output.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "noEmitOnError": true, // Disable emitting files if any type checking errors are reported.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "preserveConstEnums": true, // Disable erasing 'const enum' declarations in generated code.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "declarationDir": "./", // Specify the output directory for generated declaration files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Section 6: Interop Constraints</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "isolatedModules": true, // &lt;--- Setting to `true` tells TypeScript to warn you if you write certain code that can't be correctly interpreted by a single-file transpilation process. Ensure that each file can be safely transpiled without relying on other imports.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "esModuleInterop": true, // Emit additional JavaScript to ease support for importing CommonJS modules. This enables 'allowSyntheticDefaultImports' for type compatibility.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "allowSyntheticDefaultImports": true, // Allow 'import x from y' when a module doesn't have a default export.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "forceConsistentCasingInFileNames": true, // Ensure that casing is correct in imports.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "preserveSymlinks": true, // &lt;--- Solved being redirected to node_modules/.pnpm symlink all the time! Disable resolving symlinks to their realpath. This correlates to the same flag in node. But on the other-hand, I wasn't able to import Page as type from playwright in jsdoc. Disable resolving symlinks to their realpath. This correlates to the same flag in node.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "verbatimModuleSyntax": true,                     /* Do not transform or elide any imports or exports not marked as type-only, ensuring they are written in the output file's format based on the 'module' setting. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "isolatedDeclarations": true,                     /* Require sufficient annotation on exports so other tools can trivially generate declaration files. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Section 7: Type Checking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /* Linting */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "strictNullChecks": true,                         // &lt;--- When type checking, take into account 'null' and 'undefined'.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "strictFunctionTypes": true,                      // &lt;--- When assigning functions, check to ensure parameters and the return values are subtype-compatible.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "strictBindCallApply": true,                      // &lt;--- Check that the arguments for 'bind', 'call', and 'apply' methods match the original function.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "strictPropertyInitialization": true,             // &lt;--- Check for class properties that are declared but not set in the constructor.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "strict": true, // &lt;--- Enable all strict type-checking options.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "noImplicitAny": true, // &lt;--- Enable error reporting for expressions and declarations with an implied 'any' type.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "noImplicitThis": true, // &lt;---Enable error reporting when 'this' is given the type 'any'.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "useUnknownInCatchVariables": true, // &lt;--- Default catch clause variables as 'unknown' instead of 'any'.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "alwaysStrict": true, // &lt;--- Ensure 'use strict' is always emitted.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "noUnusedLocals": true, // &lt;--- Enable error reporting when local variables aren't read.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "noUnusedParameters": true, // &lt;--- Raise an error when a function parameter isn't read.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "exactOptionalPropertyTypes": false, // &lt;--- Interpret optional property types as written, rather than adding 'undefined'.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "noImplicitReturns": true, // &lt;--- Enable error reporting for codepaths that do not explicitly return in a function.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "noFallthroughCasesInSwitch": true, // &lt;--- Enable error reporting for fallthrough cases in switch statements.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "noUncheckedIndexedAccess": true, // &lt;--- Add 'undefined' to a type when accessed using an index.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "noImplicitOverride": true, // &lt;--- Ensure overriding members in derived classes are marked with an override modifier.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "noPropertyAccessFromIndexSignature": false, // &lt;--- settings this to true marks obj['firstName'] as an error, and recommends obj.firstName instead. Enforces using indexed accessors for keys declared using an indexed type.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "allowUnusedLabels": false, // &lt;--- Disable error reporting for unused labels.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "allowUnreachableCode": true,                     // &lt;--- Disable error reporting for unreachable code.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // -----------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Section 8: Completeness</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // -----------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "skipLibCheck": true // Skip type checking all .d.ts files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // "skipDefaultLibCheck": true,                      /* Skip type checking .d.ts files that are included with TypeScript. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  "include": ["lib"]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The important part to notice is that the "include" key of it has the value of ["lib"], to have our typescript rules be applied only to the <code>lib</code> folder, and not the <code>src</code>.</p>
<p>Implementing this separate configuration helps avoid TypeScript errors when you import components directly from the <code>dist</code> folder on the demo page and those components haven't been built yet.</p>
<h2 class="anchor anchorWithStickyNavbar_MJR6" id="5-use-the-tsconfigbuildts-for-building">5. Use the tsconfig.build.ts for building<a class="hash-link" aria-label="קישור ישיר אל 5. Use the tsconfig.build.ts for building" title="קישור ישיר אל 5. Use the tsconfig.build.ts for building" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#5-use-the-tsconfigbuildts-for-building">​</a></h2>
<p>To use <code>tsconfig.build.json</code> for building you need to pass the configuration file to <code>tsc</code> in the build script in your package.json:</p>
<div class="language-json codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-json codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  "scripts": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ...</span><br></span><span class="token-line custom-code-block-diff-remove" style="color:#393A34"><span class="token plain">  "build": "tsc &amp;&amp; vite build",</span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">  "build": "tsc -p ./tsconfig.build.json &amp;&amp; vite build",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_MJR6" id="6-copy-vite-envdts-from-src-to-lib">6. Copy <code>vite-env.d.ts</code> from <code>src</code> to <code>lib</code><a class="hash-link" aria-label="קישור ישיר אל 6-copy-vite-envdts-from-src-to-lib" title="קישור ישיר אל 6-copy-vite-envdts-from-src-to-lib" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#6-copy-vite-envdts-from-src-to-lib">​</a></h2>
<p>You will also need to copy the file <code>vite-env.d.ts</code> from <code>src</code> to <code>lib</code>. Without this file Typescript will miss some types definitions provided by Vite when building (because we don't include <code>src</code> in our <code>tsconfig.build.ts</code>).</p>
<h2 class="anchor anchorWithStickyNavbar_MJR6" id="7-set-emptyoutdir-to-false">7. Set <code>emptyOutDir</code> to <code>false</code><a class="hash-link" aria-label="קישור ישיר אל 7-set-emptyoutdir-to-false" title="קישור ישיר אל 7-set-emptyoutdir-to-false" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#7-set-emptyoutdir-to-false">​</a></h2>
<p>By default, vite empties the output directory.</p>
<p>This <em>would</em> have been a good behavior, if we weren't using types being compiled with typescript.</p>
<p>See, what happens now is that typescript creates types (just the types), puts them inside the <code>dist</code> folder, and then comes along vite and deletes them. We want to cancel that behavior:</p>
<div class="language-tsx codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-tsx codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> defineConfig </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'vite'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">defineConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  build</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    emptyOutDir</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// &lt;--- defaults to `true`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can now execute <code>npm run build</code> and this is what you will see in your <code>dist</code> folder:</p>
<div class="language-bash codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-bash codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain"> 📂dist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┣ 📜my-component-library.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┣ 📜main.d.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┣ 📜main.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┗ 📜vite.svg</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_TgxI alert alert--info"><div class="admonitionHeading_HhRy"><span class="admonitionIcon_HWzh"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_jBTa"><p>💡 The name of the output file is identical with the <code>name</code> property in your package.json per default. This can be changed in the Vite config (<code>build.lib.fileName</code>) but we will do something else about this later.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_MJR6" id="8-get-rid-of-the-vitesvg-file">8. Get rid of the <code>vite.svg</code> file<a class="hash-link" aria-label="קישור ישיר אל 8-get-rid-of-the-vitesvg-file" title="קישור ישיר אל 8-get-rid-of-the-vitesvg-file" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#8-get-rid-of-the-vitesvg-file">​</a></h2>
<p>The file <code>vite.svg</code> is in your <code>dist</code> folder because Vite copies all files from the <code>public</code> directory to the output folder. Let's disable this behavior:</p>
<div class="language-tsx codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-tsx codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX codeBlockLinesWithNumbering_MhpT"><span class="token-line codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">defineConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain">  build</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line custom-code-block-diff-add codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain">    copyPublicDir</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_btop" style="color:#393A34"><span class="codeLineNumber_K6Fb"></span><span class="codeLineContent_HG3C"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_MJR6" id="9-create-a-basic-component">9. Create a basic component<a class="hash-link" aria-label="קישור ישיר אל 9. Create a basic component" title="קישור ישיר אל 9. Create a basic component" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#9-create-a-basic-component">​</a></h2>
<p>What is a React component library without components?<br>
<!-- -->Let's create one or two:</p>
<div class="language-bash codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-bash codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain"> 📂 my-component-library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┣ 📂 lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> +┃ ┣ 📂 components</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> +┃ ┃ ┣ 📂 Button</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> +┃ ┃ ┃ ┣ 📂 Button.tsx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> +┃ ┃ ┃ ┗ 📜 index.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> +┃ ┃ ┗ 📂 Label</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> +┃ ┃ ┃ ┣ 📂 Label.tsx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> +┃ ┃   ┗ 📜 index.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┃ ┗ 📜 main.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  …</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And add a very basic implementation for these components:</p>
<div class="language-tsx codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-tsx codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Button</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">props</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">ButtonHTMLAttributes</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">HTMLButtonElement</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">button</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">'</span><span class="token tag attr-value" style="color:#e3116c">button</span><span class="token tag attr-value punctuation" style="color:#393A34">'</span><span class="token tag" style="color:#00009f"> </span><span class="token tag spread punctuation" style="color:#393A34">{</span><span class="token tag spread operator" style="color:#393A34">...</span><span class="token tag spread" style="color:#00009f">props</span><span class="token tag spread punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-tsx codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-tsx codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Label</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">props</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">LabelHTMLAttributes</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">HTMLLabelElement</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">label</span><span class="token tag" style="color:#00009f"> </span><span class="token tag spread punctuation" style="color:#393A34">{</span><span class="token tag spread operator" style="color:#393A34">...</span><span class="token tag spread" style="color:#00009f">props</span><span class="token tag spread punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Finally export the components from the library's main file:</p>
<div class="language-tsx codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-tsx codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token exports punctuation" style="color:#393A34">{</span><span class="token exports"> </span><span class="token exports keyword module" style="color:#00009f">default</span><span class="token exports"> </span><span class="token exports keyword module" style="color:#00009f">as</span><span class="token exports"> </span><span class="token exports maybe-class-name">Button</span><span class="token exports"> </span><span class="token exports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'./components/Button'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token exports punctuation" style="color:#393A34">{</span><span class="token exports"> </span><span class="token exports keyword module" style="color:#00009f">default</span><span class="token exports"> </span><span class="token exports keyword module" style="color:#00009f">as</span><span class="token exports"> </span><span class="token exports maybe-class-name">Label</span><span class="token exports"> </span><span class="token exports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'./components/Label'</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you <code>npm run build</code> again you will notice that the transpiled file <code>my-component-library.js</code> now has <strong>78kb</strong> 😮</p>
<h2 class="anchor anchorWithStickyNavbar_MJR6" id="10-remove-react--reactjsx-runtime-from-the-bundle">10. Remove <code>react</code> &amp; <code>react/jsx-runtime</code> from the bundle<a class="hash-link" aria-label="קישור ישיר אל 10-remove-react--reactjsx-runtime-from-the-bundle" title="קישור ישיר אל 10-remove-react--reactjsx-runtime-from-the-bundle" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#10-remove-react--reactjsx-runtime-from-the-bundle">​</a></h2>
<p>The implementation of the components above contains React JSX code and therefore <code>react</code> (and <code>react/jsx-runtime</code>) gets bundled as well. As this library will be used in projects that have React installed anyways, you can <strong>externalize</strong> this dependencies to <em>remove the code from bundle</em>:</p>
<div class="language-tsx codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-tsx codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">defineConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  build</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">   rollupOptions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">       external</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'react'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'react/jsx-runtime'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now take a look at your <code>package.json</code> file under <code>dependencies</code> key. Right now there should be only two there: <code>react</code> and <code>react-dom</code> You can move both to the <code>devDependencies</code>. Additionally, add them as <code>peerDependencies</code>, so that the consuming application is aware that it must have React installed to use this package.</p>
<div class="language-json codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-json codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line custom-code-block-diff-remove" style="color:#393A34"><span class="token plain">"dependencies": {</span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">"peerDependencies": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  "react": "^18.2.0",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "react-dom": "^18.2.0"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  "devDependencies": {</span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">"react": "^18.2.0",</span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">"react-dom": "^18.2.0",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_MJR6" id="11-handle-css-files">11. Handle CSS files<a class="hash-link" aria-label="קישור ישיר אל 11. Handle CSS files" title="קישור ישיר אל 11. Handle CSS files" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#11-handle-css-files">​</a></h2>
<p>This library will use <strong>CSS modules</strong> to style the components.</p>
<p>CSS modules are supported by Vite by default. All you have to do is to create CSS files that end with <code>.module.css</code> (or <code>.module.scss</code>).</p>
<div class="language-bash codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-bash codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain"> 📂my-component-library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┣ 📂lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┃ ┣ 📂components</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┃ ┃ ┣ 📂Button</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┃ ┃ ┃ ┣ 📂Button.tsx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┃ ┃ ┃ ┣ 📜index.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ ┃ ┃ ┃ ┗ 📂Button.module.scss</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┃ ┃ ┗ 📂Label</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┃ ┃   ┣ 📂Label.tsx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┃ ┃   ┣ 📜index.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ ┃ ┃   ┗ 📂Label.module.scss</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┃ ┗ 📜main.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  …</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And add some basic CSS classes:</p>
<div class="language-css codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-css codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token selector class" style="color:#00009f">.button</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">padding</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token unit">rem</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-css codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-css codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token selector class" style="color:#00009f">.label</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">font-weight</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> bold</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And import/use them inside your components:</p>
<div class="language-tsx codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-tsx codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports">styles</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'./Button.module.scss'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Button</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">props</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">ButtonHTMLAttributes</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">HTMLButtonElement</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> className</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">restProps </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> props</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">button</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">'</span><span class="token tag attr-value" style="color:#e3116c">button</span><span class="token tag attr-value punctuation" style="color:#393A34">'</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:#e3116c">`</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token tag script language-javascript template-string interpolation" style="color:#00009f">className</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token tag script language-javascript template-string string" style="color:#e3116c"> </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token tag script language-javascript template-string interpolation" style="color:#00009f">styles</span><span class="token tag script language-javascript template-string interpolation punctuation" style="color:#393A34">.</span><span class="token tag script language-javascript template-string interpolation" style="color:#00009f">button</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:#e3116c">`</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag spread punctuation" style="color:#393A34">{</span><span class="token tag spread operator" style="color:#393A34">...</span><span class="token tag spread" style="color:#00009f">restProps</span><span class="token tag spread punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you choose to use <code>.scss</code> instead of <code>.css</code> files, you'll need <code>sass</code>:</p>
<div class="language-bash codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-bash codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm add -D sass</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>So now, after transpiling your library you will notice that there is a new file in your distribution folder:</p>
<div class="language-bash codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-bash codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain"> 📂dist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┣ …</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┣ 📜my-component-library.js</span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">┗ 📜style.css</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>But there are two issues with this file:</p>
<ol>
<li>You need to manually import the file in the consuming application.</li>
<li>It is one big giant file that contains all styles for all components.</li>
</ol>
<p>CSS files just can't easily be imported in JavaScript. Therefore, the CSS file is generated separately, allowing the library user to decide how to handle the file.</p>
<p>But what if we were to assume that the application using the library has a bundler configuration that can handle CSS imports?</p>
<p>For this to work, the transpiled JavaScript bundle must contain an import statement for the CSS file. We are going to use yet another Vite plugin (<a href="https://github.com/emosheeep/vite-plugin-lib-inject-css" target="_blank" rel="noopener noreferrer">vite-plugin-lib-inject-css</a>) that does exactly what we need with zero configuration.</p>
<div class="theme-admonition theme-admonition-tip admonition_TgxI alert alert--success"><div class="admonitionHeading_HhRy"><span class="admonitionIcon_HWzh"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_jBTa"><p><strong>From their documentation:</strong></p><p>"Inject css at the top of each chunk file in library mode using import statement, support multi-entries build, especially to help building component libraries."</p></div></div>
<p>Let's install <code>vite-plugin-lib-inject-css</code>:</p>
<div class="language-bash codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-bash codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm add -D vite-plugin-lib-inject-css</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And use it inside our <code>vite.config.ts</code> file:</p>
<div class="language-tsx codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-tsx codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> libInjectCss </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'vite-plugin-lib-inject-css'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">defineConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  plugins</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">react</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">libInjectCss</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Build the library and take a look at the top of your bundled JavaScript file (<code>dist/my-component-library.js</code>):</p>
<div class="language-tsx codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-tsx codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'./main.css'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_TgxI alert alert--info"><div class="admonitionHeading_HhRy"><span class="admonitionIcon_HWzh"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_jBTa"><p>💡 You may notice that the CSS filename has changed from style.css to main.css. This change occurs because the plugin generates a separate CSS file for each chunk, and in this case the name of the chunk comes from the filename of the entry file.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_MJR6" id="12-split-up-the-css">12. Split up the CSS<a class="hash-link" aria-label="קישור ישיר אל 12. Split up the CSS" title="קישור ישיר אל 12. Split up the CSS" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#12-split-up-the-css">​</a></h2>
<p>But there's still the second problem: when you import something from your library, <code>main.css</code> is also imported and all the CSS styles end up in your application bundle. Even if you only import the <strong>Button</strong>.</p>
<p>Well, good news!!! The <code>libInjectCSS</code> plugin generates a separate CSS file for each chunk and includes an import statement at the beginning of each chunk's output file. So if you split up the JavaScript code, you'll end up having separate CSS files that only get imported when the according JavaScript files are imported.</p>
<p>Best way of doing this would be to turn every file into an Rollup entry point. And there is a recommended way of doing this right in the <a href="https://rollupjs.org/configuration-options/#input" target="_blank" rel="noopener noreferrer">Rollup documentation</a>:</p>
<p>So let's add this to your configuration.</p>
<p>First install <code>glob</code> as it will be required:</p>
<div class="language-bash codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-bash codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm add -D glob</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then change your Vite config to this:</p>
<div class="language-tsx codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-tsx codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/* eslint-disable*/</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-remove" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> resolve </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'path'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> extname</span><span class="token imports punctuation" style="color:#393A34">,</span><span class="token imports"> relative</span><span class="token imports punctuation" style="color:#393A34">,</span><span class="token imports"> resolve </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'path'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> glob </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'glob'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> fileURLToPath </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'node:url'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">defineConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rollupOptions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      external</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'react'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'react/jsx-runtime'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">     input</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">fromEntries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">         glob</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">sync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'lib/**/*.{ts,tsx}'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">             ignore</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'lib/**/*.d.ts'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// The name of the entry point lib/nested/foo.ts becomes nested/foo</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">         </span><span class="token function" style="color:#d73a49">relative</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">             </span><span class="token string" style="color:#e3116c">'lib'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">           file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">slice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">extname</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// The absolute path to the entry file lib/nested/foo.ts becomes /project/lib/nested/foo.ts</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">         </span><span class="token function" style="color:#d73a49">fileURLToPath</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name constant" style="color:#36acaa">URL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">import</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">meta</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_TgxI alert alert--info"><div class="admonitionHeading_HhRy"><span class="admonitionIcon_HWzh"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_jBTa"><p>💡 The glob library helps you to specify a set of filenames. In this case it selects all files ending with <code>.ts</code> or <code>.tsx</code> and ignores <code>*.d.ts</code> files.</p></div></div>
<p><strong>How to use Storybook for my library?</strong></p>
<p>To install Storybook run <code>npx storybook@latest init</code> and start adding your stories.</p>
<p>If you add stories inside the <code>lib</code> folder you also need to make sure to exclude all <code>.stories.tsx</code> files from the glob pattern so the stories don't end up in your bundle.</p>
<div class="language-tsx codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-tsx codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain">glob</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">sync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'lib/**/*.{ts,tsx}'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-remove" style="color:#393A34"><span class="token plain">  ignore</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'lib/**/*.d.ts'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">  ignore</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'lib/**/*.d.ts'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'lib/**/*.stories.tsx'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now you end up with a bunch of JavaScript and CSS files in the root of your <code>dist</code> folder. It works, but it doesn't look particularly pretty, does it?</p>
<p>That's why we'll add <code>rollupOptions.output</code> to our config:</p>
<div class="language-tsx codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-tsx codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">defineConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rollupOptions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">     output</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">       assetFileNames</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'assets/[name][extname]'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">       entryFileNames</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'[name].js'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Transpile the library again and all JavaScript files should now be in the same organized folder structure you have created in <code>lib</code> alongside with their type definitions. And the CSS files are inside a new folder called assets. 🙌</p>
<p>Notice that the name of the main file has changed from "my-component-library.js" to "main.js". That's great!</p>
<h2 class="anchor anchorWithStickyNavbar_MJR6" id="13-update-your-packagejson-file">13. Update your <code>package.json</code> file<a class="hash-link" aria-label="קישור ישיר אל 13-update-your-packagejson-file" title="קישור ישיר אל 13-update-your-packagejson-file" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#13-update-your-packagejson-file">​</a></h2>
<p>main &amp; types should be <code>dist/main.js</code> and <code>dist/main.d.ts</code>.</p>
<p>Your library's primary entry point is now located at <code>dist/main.js</code>, so this needs to be set in your <code>package.json</code>.</p>
<p>The same applies to the types' entry point: <code>dist/main.d.ts</code></p>
<div class="language-json codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-json codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  "name": "my-component-library",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  "private": true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  "version": "0.0.0",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  "type": "module",</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">  "main": "dist/main.js",</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">  "types": "dist/main.d.ts",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_MJR6" id="14-add-css-to-side-effects">14. Add CSS to Side effects<a class="hash-link" aria-label="קישור ישיר אל 14. Add CSS to Side effects" title="קישור ישיר אל 14. Add CSS to Side effects" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#14-add-css-to-side-effects">​</a></h2>
<p>To prevent the CSS files from being accidentally removed by the consumer's tree-shaking efforts, you should also specify the generated CSS as side effects:</p>
<div class="language-json codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-json codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ...</span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">"sideEffects": ["**/*.css"],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_MJR6" id="15-use-prepublishonly-to-ensure-build-prior-to-publish">15. Use <code>prepublishOnly</code> to ensure build prior to publish<a class="hash-link" aria-label="קישור ישיר אל 15-use-prepublishonly-to-ensure-build-prior-to-publish" title="קישור ישיר אל 15-use-prepublishonly-to-ensure-build-prior-to-publish" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#15-use-prepublishonly-to-ensure-build-prior-to-publish">​</a></h2>
<p>You can use the special lifecycle script <code>prepublishOnly</code> to guarantee that your changes are always built before the package is published:</p>
<div class="language-json codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-json codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  "scripts": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "dev": "vite",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "build": "tsc &amp;&amp; vite build",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ...</span><br></span><span class="token-line custom-code-block-diff-add" style="color:#393A34"><span class="token plain">  "prepublishOnly": "npm run build"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_MJR6" id="16-demo-page">16. Demo page<a class="hash-link" aria-label="קישור ישיר אל 16. Demo page" title="קישור ישיר אל 16. Demo page" href="https://talkohavy.github.io/guides/he/blog/vite-library-mode/#16-demo-page">​</a></h2>
<p>To just play around with your components on the demo page, you can simply import the components directly from the root of your project. This works because your <code>package.json</code> points to the transpiled main file <code>dist/main.ts</code>.</p>
<div class="language-tsx codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-tsx codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/* eslint-disable */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Button</span><span class="token imports punctuation" style="color:#393A34">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">Input</span><span class="token imports punctuation" style="color:#393A34">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">Label</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'../'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <category>vite</category>
            <category>react</category>
            <category>typescript</category>
            <category>tutorial</category>
        </item>
        <item>
            <title><![CDATA[Welcome]]></title>
            <link>https://talkohavy.github.io/guides/he/blog/welcome/</link>
            <guid>https://talkohavy.github.io/guides/he/blog/welcome/</guid>
            <pubDate>Thu, 26 Aug 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[Docusaurus blogging features are powered by the blog plugin.]]></description>
            <content:encoded><![CDATA[<p><a href="https://docusaurus.io/docs/blog" target="_blank" rel="noopener noreferrer">Docusaurus blogging features</a> are powered by the <a href="https://docusaurus.io/docs/api/plugins/@docusaurus/plugin-content-blog" target="_blank" rel="noopener noreferrer">blog plugin</a>.</p>
<p>Simply add Markdown files (or folders) to the <code>blog</code> directory.</p>
<p>Regular blog authors can be added to <code>authors.yml</code>.</p>
<p>The blog post date can be extracted from filenames, such as:</p>
<ul>
<li><code>2019-05-30-welcome.md</code></li>
<li><code>2019-05-30-welcome/index.md</code></li>
</ul>
<p>A blog post folder can be convenient to co-locate blog post images:</p>
<p><img decoding="async" loading="lazy" alt="Docusaurus Plushie" src="https://talkohavy.github.io/guides/he/assets/images/docusaurus-plushie-banner-a60f7593abca1e3eef26a9afa244e4fb.jpeg" width="1500" height="500" class="img_repL"></p>
<p>The blog supports tags as well!</p>
<p><strong>And if you don't want a blog</strong>: just delete this directory, and use <code>blog: false</code> in your Docusaurus config.</p>]]></content:encoded>
            <category>facebook</category>
            <category>hello</category>
            <category>docusaurus</category>
        </item>
        <item>
            <title><![CDATA[MDX Blog Post]]></title>
            <link>https://talkohavy.github.io/guides/he/blog/mdx-blog-post/</link>
            <guid>https://talkohavy.github.io/guides/he/blog/mdx-blog-post/</guid>
            <pubDate>Sun, 01 Aug 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[Blog posts support Docusaurus Markdown features, such as MDX.]]></description>
            <content:encoded><![CDATA[<p>Blog posts support <a href="https://docusaurus.io/docs/markdown-features" target="_blank" rel="noopener noreferrer">Docusaurus Markdown features</a>, such as <a href="https://mdxjs.com/" target="_blank" rel="noopener noreferrer">MDX</a>.</p>
<div class="theme-admonition theme-admonition-tip admonition_TgxI alert alert--success"><div class="admonitionHeading_HhRy"><span class="admonitionIcon_HWzh"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_jBTa"><p>Use the power of React to create interactive blog posts.</p><div class="language-js codeBlockContainer_W3JC theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_hTAL"><pre tabindex="0" class="prism-code language-js codeBlock_BAh0 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ZFRX"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'button clicked!'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token maybe-class-name">Click</span><span class="token plain"> me</span><span class="token operator" style="color:#393A34">!</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">button</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup_YHIj"><button type="button" aria-label="העתק קוד ללוח העריכה" title="העתק" class="clean-btn"><span class="copyButtonIcons_lVaM" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_x_ro"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fX90"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><button>Click me!</button></div></div>]]></content:encoded>
            <category>docusaurus</category>
        </item>
        <item>
            <title><![CDATA[Greetings!]]></title>
            <link>https://talkohavy.github.io/guides/he/blog/greetings/</link>
            <guid>https://talkohavy.github.io/guides/he/blog/greetings/</guid>
            <pubDate>Sun, 28 Feb 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[Congratulations, you have made your first post!]]></description>
            <content:encoded><![CDATA[<p>Congratulations, you have made your first post!</p>
<p>Feel free to play around and edit this post as much you like.</p>]]></content:encoded>
            <category>greetings</category>
        </item>
        <item>
            <title><![CDATA[Long Blog Post]]></title>
            <link>https://talkohavy.github.io/guides/he/blog/long-blog-post/</link>
            <guid>https://talkohavy.github.io/guides/he/blog/long-blog-post/</guid>
            <pubDate>Wed, 29 May 2019 00:00:00 GMT</pubDate>
            <description><![CDATA[This is the summary of a very long blog post,]]></description>
            <content:encoded><![CDATA[<p>This is the summary of a very long blog post,</p>
<p>Use a <code>&lt;!--</code> <code>truncate</code> <code>--&gt;</code> comment to limit blog post size in the list view.</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>]]></content:encoded>
            <category>hello</category>
            <category>docusaurus</category>
        </item>
        <item>
            <title><![CDATA[First Blog Post]]></title>
            <link>https://talkohavy.github.io/guides/he/blog/first-blog-post/</link>
            <guid>https://talkohavy.github.io/guides/he/blog/first-blog-post/</guid>
            <pubDate>Tue, 28 May 2019 00:00:00 GMT</pubDate>
            <description><![CDATA[Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet]]></description>
            <content:encoded><![CDATA[<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>]]></content:encoded>
            <category>hola</category>
            <category>docusaurus</category>
        </item>
    </channel>
</rss>