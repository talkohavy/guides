"use strict";(self.webpackChunkdocusaurus_guides=self.webpackChunkdocusaurus_guides||[]).push([[1716],{6721:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"programming/web/http/cache-control-headers","title":"Cache-Control Headers","description":"The Cache-Control HTTP header is the primary mechanism for controlling caching behavior in browsers and intermediate caches (proxies, CDNs). It can be used in both requests and responses to specify exactly how caching should work.","source":"@site/docs/programming/web/http/cache-control-headers.md","sourceDirName":"programming/web/http","slug":"/programming/web/http/cache-control-headers","permalink":"/guides/he/docs/programming/web/http/cache-control-headers","draft":false,"unlisted":false,"editUrl":"https://github.com/talkohavy/guides/docs/programming/web/http/cache-control-headers.md","tags":[],"version":"current","frontMatter":{},"sidebar":"mySidebar","previous":{"title":"- MIME types","permalink":"/guides/he/docs/programming/web/http/mime-type"},"next":{"title":"- Iframe","permalink":"/guides/he/docs/programming/web/iframe"}}');var i=n(5813),c=n(3546);const a={},t="Cache-Control Headers",l={},o=[{value:"1. Basic Syntax",id:"1-basic-syntax",level:2},{value:"2. Key Concepts",id:"2-key-concepts",level:2},{value:"A. Cache Types",id:"a-cache-types",level:3},{value:"B. Response States",id:"b-response-states",level:3},{value:"C. Cache Operations",id:"c-cache-operations",level:3},{value:"3. Response Directives",id:"3-response-directives",level:2},{value:"A. Freshness Control",id:"a-freshness-control",level:3},{value:"<code>max-age=&lt;seconds&gt;</code>",id:"max-ageseconds",level:4},{value:"<code>s-maxage=&lt;seconds&gt;</code>",id:"s-maxageseconds",level:4},{value:"B. Storage Control",id:"b-storage-control",level:3},{value:"<code>no-store</code>",id:"no-store",level:4},{value:"<code>no-cache</code>",id:"no-cache",level:4},{value:"<code>private</code>",id:"private",level:4},{value:"<code>public</code>",id:"public",level:4},{value:"C. Validation Control",id:"c-validation-control",level:3},{value:"<code>must-revalidate</code>",id:"must-revalidate",level:4},{value:"<code>proxy-revalidate</code>",id:"proxy-revalidate",level:4},{value:"D. Advanced Directives",id:"d-advanced-directives",level:3},{value:"<code>immutable</code>",id:"immutable",level:4},{value:"<code>stale-while-revalidate=&lt;seconds&gt;</code>",id:"stale-while-revalidateseconds",level:4},{value:"<code>stale-if-error=&lt;seconds&gt;</code>",id:"stale-if-errorseconds",level:4},{value:"<code>no-transform</code>",id:"no-transform",level:4},{value:"4. Request Directives",id:"4-request-directives",level:2},{value:"<code>no-cache</code>",id:"no-cache-1",level:4},{value:"<code>no-store</code>",id:"no-store-1",level:4},{value:"<code>max-age=&lt;seconds&gt;</code>",id:"max-ageseconds-1",level:4},{value:"<code>max-stale=&lt;seconds&gt;</code>",id:"max-staleseconds",level:4},{value:"<code>min-fresh=&lt;seconds&gt;</code>",id:"min-freshseconds",level:4},{value:"<code>only-if-cached</code>",id:"only-if-cached",level:4},{value:"5. Practical Examples",id:"5-practical-examples",level:2},{value:"Static Assets (CSS, JS, Images)",id:"static-assets-css-js-images",level:3},{value:"API Responses",id:"api-responses",level:3},{value:"HTML Pages",id:"html-pages",level:3},{value:"CDN Optimization",id:"cdn-optimization",level:3},{value:"7. Best Practices",id:"7-best-practices",level:2},{value:"\u2705 Do&#39;s",id:"-dos",level:3},{value:"\u274c Don&#39;ts",id:"-donts",level:3},{value:"Quick Reference",id:"quick-reference",level:3}];function d(e){const s={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"cache-control-headers",children:"Cache-Control Headers"})}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"Cache-Control"})," HTTP header is the primary mechanism for controlling caching behavior in browsers and intermediate caches (proxies, CDNs). It can be used in both requests and responses to specify exactly how caching should work."]}),"\n",(0,i.jsx)(s.h2,{id:"1-basic-syntax",children:"1. Basic Syntax"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"Cache-Control: <directive>, <directive>, ...\n"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Rules:"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Directives are case-insensitive (but lowercase is recommended)"}),"\n",(0,i.jsx)(s.li,{children:"Multiple directives are comma-separated"}),"\n",(0,i.jsxs)(s.li,{children:["Some directives take arguments separated by ",(0,i.jsx)(s.code,{children:"="})]}),"\n",(0,i.jsx)(s.li,{children:"Arguments are typically integers without quotes"}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"Cache-Control: max-age=3600, public\nCache-Control: no-cache, must-revalidate\nCache-Control: private, max-age=0\n"})}),"\n",(0,i.jsx)(s.h2,{id:"2-key-concepts",children:"2. Key Concepts"}),"\n",(0,i.jsx)(s.h3,{id:"a-cache-types",children:"A. Cache Types"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Private Cache"}),": Browser cache, stores content for a single user"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Shared Cache"}),": Proxy/CDN cache, stores content for multiple users"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Origin Server"}),": The original source of the content"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"b-response-states",children:"B. Response States"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Fresh"}),": Response can be used without validation"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Stale"}),": Response is outdated and should be validated"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Age"}),": Time since response was generated on origin server"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"c-cache-operations",children:"C. Cache Operations"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Store"}),": Save response in cache"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Reuse"}),": Serve cached response without contacting origin"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Revalidate"}),": Check with origin if cached response is still valid"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"3-response-directives",children:"3. Response Directives"}),"\n",(0,i.jsx)(s.p,{children:"These directives are sent by the server to control how responses are cached."}),"\n",(0,i.jsx)(s.h3,{id:"a-freshness-control",children:"A. Freshness Control"}),"\n",(0,i.jsx)(s.h4,{id:"max-ageseconds",children:(0,i.jsx)(s.code,{children:"max-age=<seconds>"})}),"\n",(0,i.jsx)(s.p,{children:"Sets how long the response remains fresh."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"Cache-Control: max-age=3600  # Fresh for 1 hour\n"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Key points:"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Most important caching directive"}),"\n",(0,i.jsx)(s.li,{children:"If not set, defaults to browser's heuristics"}),"\n",(0,i.jsx)(s.li,{children:"Time is calculated from when response was generated, not received"}),"\n",(0,i.jsx)(s.li,{children:"Value is in seconds"}),"\n",(0,i.jsxs)(s.li,{children:["Negative values or non-integers are treated as ",(0,i.jsx)(s.code,{children:"0"})]}),"\n"]}),"\n",(0,i.jsx)(s.h4,{id:"s-maxageseconds",children:(0,i.jsx)(s.code,{children:"s-maxage=<seconds>"})}),"\n",(0,i.jsxs)(s.p,{children:["Like ",(0,i.jsx)(s.code,{children:"max-age"})," but only for shared caches. Overrides ",(0,i.jsx)(s.code,{children:"max-age"})," for proxies/CDNs."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"Cache-Control: max-age=300, s-maxage=3600  # 5 min for browsers, 1 hour for CDNs\n"})}),"\n",(0,i.jsx)(s.h3,{id:"b-storage-control",children:"B. Storage Control"}),"\n",(0,i.jsx)(s.h4,{id:"no-store",children:(0,i.jsx)(s.code,{children:"no-store"})}),"\n",(0,i.jsx)(s.p,{children:"Prevents any caching whatsoever. Response is not stored anywhere."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"Cache-Control: no-store  # Never cache this response\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Use for:"})," Sensitive data, personal information, payment details"]}),"\n",(0,i.jsx)(s.h4,{id:"no-cache",children:(0,i.jsx)(s.code,{children:"no-cache"})}),"\n",(0,i.jsxs)(s.p,{children:["\u26a0\ufe0f ",(0,i.jsx)(s.strong,{children:"Common misconception"}),': This does NOT mean "don\'t cache"!']}),"\n",(0,i.jsxs)(s.p,{children:['Actually means: "Cache it, but always validate with origin before reuse"',(0,i.jsx)(s.br,{}),"\n",'Another phrase: "Never serve ',(0,i.jsx)(s.strong,{children:"fresh"}),' response without first validating it with the server"']}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"Cache-Control: no-cache  # Cache but always revalidate\n"})}),"\n",(0,i.jsx)(s.h4,{id:"private",children:(0,i.jsx)(s.code,{children:"private"})}),"\n",(0,i.jsx)(s.p,{children:"Response can only be cached by private caches (browsers), not shared caches."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"Cache-Control: private  # Only browsers can cache this\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Use for:"})," User-specific content, personalized responses"]}),"\n",(0,i.jsx)(s.h4,{id:"public",children:(0,i.jsx)(s.code,{children:"public"})}),"\n",(0,i.jsxs)(s.p,{children:["Response can be cached by any cache, even when normally it wouldn't be (e.g., with ",(0,i.jsx)(s.code,{children:"Authorization"})," header)."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"Cache-Control: public, max-age=3600\n"})}),"\n",(0,i.jsx)(s.h3,{id:"c-validation-control",children:"C. Validation Control"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"\u26a0\ufe0f Common Misconception: When Do Browsers Actually Validate?"})}),"\n",(0,i.jsxs)(s.p,{children:["Many developers believe that browsers never revalidate fresh responses unless explicitly told to with ",(0,i.jsx)(s.code,{children:"no-cache"}),". This is not entirely accurate. ",(0,i.jsx)(s.strong,{children:"Browsers may choose to validate even fresh responses"})," in several scenarios:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"User-initiated refresh"})," (F5) - Browser often validates regardless of freshness"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Force refresh"})," (Ctrl+F5/Cmd+Shift+R) - Always validates with ",(0,i.jsx)(s.code,{children:"no-cache"})," or ",(0,i.jsx)(s.code,{children:"max-age=0"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Navigation from address bar"})," - Some browsers validate more aggressively"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Heuristic decisions"})," - Based on resource type, user patterns, or browser policies"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Memory pressure"})," - When cache is full, browsers may validate before serving"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["The key difference is that validation directives like ",(0,i.jsx)(s.code,{children:"must-revalidate"})," ",(0,i.jsx)(s.strong,{children:"only"})," control what happens to ",(0,i.jsx)(s.strong,{children:"stale"})," responses (they must be validated before reuse), while fresh responses can still be served directly from cache. However, browsers may still choose to validate fresh responses in certain user-initiated scenarios regardless of cache directives."]}),"\n",(0,i.jsx)(s.h4,{id:"must-revalidate",children:(0,i.jsx)(s.code,{children:"must-revalidate"})}),"\n",(0,i.jsxs)(s.p,{children:["When a response is considered stale, and only when a response is considered stale, adding the ",(0,i.jsx)(s.code,{children:"must-revalidate"})," header tells the browser the response MUST be validated before reuse. Without ",(0,i.jsx)(s.code,{children:"must-revalidate"}),", HTTP caches are allowed to serve stale responses in certain situations (like when disconnected from the origin server).\n",(0,i.jsx)(s.strong,{children:"Never"})," use ",(0,i.jsx)(s.code,{children:"must-revalidate"})," together with one of: ",(0,i.jsx)(s.code,{children:"no-cache"}),", ",(0,i.jsx)(s.code,{children:"no-store"}),".",(0,i.jsx)(s.br,{}),"\n","Why?",(0,i.jsx)(s.br,{}),"\n","In case of ",(0,i.jsx)(s.code,{children:"no-cache"}),", you're always validating already, even when fresh, so there's nothing to re-validate.\nAnd in case of ",(0,i.jsx)(s.code,{children:"no-store"}),", it should be pretty obvious, that if you don't store anything, what is there to re-validate? Nothing."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"# \u274c CONFLICTING: Can't validate what you can't store\nCache-Control: no-store, must-revalidate\n\n# \u274c MEANINGLESS: Can't revalidate if you always validate\nCache-Control: no-cache, must-revalidate\n"})}),"\n",(0,i.jsx)(s.h4,{id:"proxy-revalidate",children:(0,i.jsx)(s.code,{children:"proxy-revalidate"})}),"\n",(0,i.jsxs)(s.p,{children:["Like ",(0,i.jsx)(s.code,{children:"must-revalidate"})," but only applies to shared caches.",(0,i.jsx)(s.br,{}),"\n",(0,i.jsx)(s.strong,{children:"Never"})," use it together with: ",(0,i.jsx)(s.code,{children:"private"}),", since it's contradicting. You're telling shared caches \"Don't store any responses, and revalidate the one you do\"."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"# \u274c REDUNDANT: Private already prevents proxy caching\nCache-Control: private, proxy-revalidate\n"})}),"\n",(0,i.jsx)(s.h3,{id:"d-advanced-directives",children:"D. Advanced Directives"}),"\n",(0,i.jsx)(s.h4,{id:"immutable",children:(0,i.jsx)(s.code,{children:"immutable"})}),"\n",(0,i.jsxs)(s.p,{children:['Adding this header to a response tells the browser: "Never validate this response while it\'s fresh".',(0,i.jsx)(s.br,{}),"\n",(0,i.jsx)(s.strong,{children:"When is it useful?"})," If your resources include cache busting in their name already, there's (near) zero chance that they'll produce the cache busting id (hash, timestamp, or semver) for a different content. This header prevents unnecessary revalidation on browser refresh.",(0,i.jsx)(s.br,{}),"\n",(0,i.jsx)(s.strong,{children:"When to avoid it?"})," Never use it on resources without cache busting, like ",(0,i.jsx)(s.code,{children:"remoteEntry.js"}),", since you can't really guarantee that a deploy will happen (for example) once every two weeks and exactly once two weeks - never less. Your users might potentially miss out on important ",(0,i.jsx)(s.code,{children:"hotfix"}),"es."]}),"\n",(0,i.jsx)(s.p,{children:"Examples of good candidates:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"app.v1.2.3.js"})," (semantic versioning)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"bundle.abc123def.js"})," (content hash)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"styles.20240928.css"})," (build timestamp)"]}),"\n"]}),"\n",(0,i.jsx)(s.h4,{id:"stale-while-revalidateseconds",children:(0,i.jsx)(s.code,{children:"stale-while-revalidate=<seconds>"})}),"\n",(0,i.jsx)(s.p,{children:"Allows serving stale content while fetching fresh content in background."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"Cache-Control: max-age=3600, stale-while-revalidate=86400\n# Fresh for 1 hour, can serve stale for 24 hours while revalidating\n"})}),"\n",(0,i.jsx)(s.h4,{id:"stale-if-errorseconds",children:(0,i.jsx)(s.code,{children:"stale-if-error=<seconds>"})}),"\n",(0,i.jsx)(s.p,{children:"Allows serving stale content when origin server returns an error (500, 502, 503, 504)."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"Cache-Control: max-age=3600, stale-if-error=86400\n# If server errors, can serve stale content for 24 hours\n"})}),"\n",(0,i.jsx)(s.h4,{id:"no-transform",children:(0,i.jsx)(s.code,{children:"no-transform"})}),"\n",(0,i.jsx)(s.p,{children:"Prevents intermediaries from modifying (for example, compressing) the response content."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"Cache-Control: no-transform  # Don't compress, convert, or modify\n"})}),"\n",(0,i.jsx)(s.h2,{id:"4-request-directives",children:"4. Request Directives"}),"\n",(0,i.jsx)(s.p,{children:"These directives are sent by clients to control caching behavior for their requests."}),"\n",(0,i.jsx)(s.h4,{id:"no-cache-1",children:(0,i.jsx)(s.code,{children:"no-cache"})}),"\n",(0,i.jsx)(s.p,{children:"Client wants the freshest possible response, bypass cache."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"Cache-Control: no-cache  # Force revalidation\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Used by:"})," Browser force-refresh (Ctrl+F5)"]}),"\n",(0,i.jsx)(s.h4,{id:"no-store-1",children:(0,i.jsx)(s.code,{children:"no-store"})}),"\n",(0,i.jsx)(s.p,{children:"Client doesn't want request/response to be stored in any cache."}),"\n",(0,i.jsx)(s.h4,{id:"max-ageseconds-1",children:(0,i.jsx)(s.code,{children:"max-age=<seconds>"})}),"\n",(0,i.jsx)(s.p,{children:"Client will accept cached response up to this age."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"Cache-Control: max-age=0  # Equivalent to no-cache for older proxies\n"})}),"\n",(0,i.jsx)(s.h4,{id:"max-staleseconds",children:(0,i.jsx)(s.code,{children:"max-stale=<seconds>"})}),"\n",(0,i.jsx)(s.p,{children:"Client will accept stale responses up to this additional time."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"Cache-Control: max-stale=3600  # Accept responses stale up to 1 hour\n"})}),"\n",(0,i.jsx)(s.h4,{id:"min-freshseconds",children:(0,i.jsx)(s.code,{children:"min-fresh=<seconds>"})}),"\n",(0,i.jsx)(s.p,{children:"Client wants responses that will remain fresh for at least this long."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"Cache-Control: min-fresh=600  # Must be fresh for at least 10 more minutes\n"})}),"\n",(0,i.jsx)(s.h4,{id:"only-if-cached",children:(0,i.jsx)(s.code,{children:"only-if-cached"})}),"\n",(0,i.jsx)(s.p,{children:"Client only wants cached responses, return 504 if nothing cached."}),"\n",(0,i.jsx)(s.h2,{id:"5-practical-examples",children:"5. Practical Examples"}),"\n",(0,i.jsx)(s.h3,{id:"static-assets-css-js-images",children:"Static Assets (CSS, JS, Images)"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"# For versioned static assets (i.e. banana.h2e5b1.js)\nCache-Control: public, max-age=31536000, immutable\n\n# For non-versioned static assets (i.e. remoteEntry.js)\nCache-Control: public, max-age=3600\n# Or...\nCache-Control: no-store\n"})}),"\n",(0,i.jsx)(s.h3,{id:"api-responses",children:"API Responses"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"# Public API data that rarely changes\nCache-Control: public, max-age=300\n\n# Private user data\nCache-Control: private, max-age=300\n\n# Real-time data\nCache-Control: no-cache\n\n# Sensitive data\nCache-Control: no-store\n"})}),"\n",(0,i.jsx)(s.h3,{id:"html-pages",children:"HTML Pages"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"# Static pages (i.e. index.html)\nCache-Control: public, max-age=3600\n\n# Dynamic pages with cache busting\nCache-Control: no-cache\n\n# Personalized pages\nCache-Control: private, max-age=0, must-revalidate\n"})}),"\n",(0,i.jsx)(s.h3,{id:"cdn-optimization",children:"CDN Optimization"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"# Different TTLs for browser vs CDN\nCache-Control: max-age=300, s-maxage=3600\n"})}),"\n",(0,i.jsx)(s.h2,{id:"7-best-practices",children:"7. Best Practices"}),"\n",(0,i.jsx)(s.h3,{id:"-dos",children:"\u2705 Do's"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Always specify Cache-Control"})," - Don't rely on heuristic caching"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Use versioning for static assets"})," - Enables aggressive caching with ",(0,i.jsx)(s.code,{children:"immutable"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Use appropriate TTLs"})," - Balance freshness vs performance"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Consider user experience"})," - Use ",(0,i.jsx)(s.code,{children:"stale-while-revalidate"})," for better UX"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Secure sensitive data"})," - Use ",(0,i.jsx)(s.code,{children:"no-store"})," for private information"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"-donts",children:"\u274c Don'ts"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsxs)(s.strong,{children:["Don't use ",(0,i.jsx)(s.code,{children:"no-cache"})," when you mean ",(0,i.jsx)(s.code,{children:"no-store"})]})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"Don't cache personalized content in shared caches"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"Don't use long TTLs without versioning"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"Don't forget about intermediate caches"})}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"quick-reference",children:"Quick Reference"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Use Case"}),(0,i.jsx)(s.th,{children:"Directive"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Never cache"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"no-store"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Always revalidate"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"no-cache"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Cache for 1 hour"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"max-age=3600"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Private only"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"private, max-age=3600"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Static assets"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"public, max-age=31536000, immutable"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"API responses"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"public, max-age=300, stale-while-revalidate=3600"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"CDN optimization"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"max-age=300, s-maxage=3600"})})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Error resilience"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"max-age=300, stale-if-error=3600"})})]})]})]})]})}function h(e={}){const{wrapper:s}={...(0,c.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},3546:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>t});var r=n(9729);const i={},c=r.createContext(i);function a(e){const s=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(c.Provider,{value:s},e.children)}}}]);