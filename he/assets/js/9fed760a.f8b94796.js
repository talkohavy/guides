"use strict";(self.webpackChunkdocusaurus_guides=self.webpackChunkdocusaurus_guides||[]).push([[8511],{9088:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"knowledge/offset-and-cursor-based-pagination","title":"The Hidden Problem with Offset-Based Pagination","description":"Knowing the differences between Cursor-Based and Offset-Based Pagination. What are the Pros & Cons for each.","source":"@site/docs/knowledge/offset-and-cursor-based-pagination.md","sourceDirName":"knowledge","slug":"/knowledge/cursor-vs-offset-pagination","permalink":"/guides/he/docs/knowledge/cursor-vs-offset-pagination","draft":false,"unlisted":false,"editUrl":"https://github.com/talkohavy/guides/docs/knowledge/offset-and-cursor-based-pagination.md","tags":[{"inline":true,"label":"database","permalink":"/guides/he/docs/tags/database"},{"inline":true,"label":"pagination","permalink":"/guides/he/docs/tags/pagination"},{"inline":true,"label":"offset","permalink":"/guides/he/docs/tags/offset"}],"version":"current","frontMatter":{"title":"The Hidden Problem with Offset-Based Pagination","description":"Knowing the differences between Cursor-Based and Offset-Based Pagination. What are the Pros & Cons for each.","slug":"cursor-vs-offset-pagination","authors":["talkohavy"],"image":"https://i.ibb.co/rGSxHmB/vite.png","tags":["database","pagination","offset"],"hide_table_of_contents":false},"sidebar":"mySidebar","previous":{"title":"- Long-Polling","permalink":"/guides/he/docs/knowledge/long-polling"},"next":{"title":"- Post vs Get Login","permalink":"/guides/he/docs/knowledge/post-vs-get-login"}}');var r=s(5813),a=s(3546);const t={title:"The Hidden Problem with Offset-Based Pagination",description:"Knowing the differences between Cursor-Based and Offset-Based Pagination. What are the Pros & Cons for each.",slug:"cursor-vs-offset-pagination",authors:["talkohavy"],image:"https://i.ibb.co/rGSxHmB/vite.png",tags:["database","pagination","offset"],hide_table_of_contents:!1},o=void 0,l={},d=[{value:"Pagination with <code>limit</code> &amp; <code>offset</code>",id:"pagination-with-limit--offset",level:2},{value:"The Familiar Approach: OFFSET-Based Pagination",id:"the-familiar-approach-offset-based-pagination",level:2},{value:"Why OFFSET Gets Slower as the Page Number Grows",id:"why-offset-gets-slower-as-the-page-number-grows",level:2},{value:"The Real Problem: We\u2019re Asking the Wrong Question",id:"the-real-problem-were-asking-the-wrong-question",level:2},{value:"Cursor-Based Pagination (a.k.a. Keyset Pagination)",id:"cursor-based-pagination-aka-keyset-pagination",level:2},{value:"First Page",id:"first-page",level:3},{value:"Next Page",id:"next-page",level:3},{value:"Why Cursor Pagination Scales",id:"why-cursor-pagination-scales",level:2},{value:"A Perfect Fit: Activity Feeds and Timelines",id:"a-perfect-fit-activity-feeds-and-timelines",level:2},{value:"When Cursor Pagination Is <em>Not</em> a Good Fit",id:"when-cursor-pagination-is-not-a-good-fit",level:2},{value:"1. You Can\u2019t Jump to Arbitrary Pages",id:"1-you-cant-jump-to-arbitrary-pages",level:3},{value:"2. Requires a Stable, Unique Sort Key",id:"2-requires-a-stable-unique-sort-key",level:3},{value:"3. More Complex Client Logic",id:"3-more-complex-client-logic",level:3},{value:"Conclusion",id:"conclusion",level:2}];function c(e){const n={blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h2,{id:"pagination-with-limit--offset",children:["Pagination with ",(0,r.jsx)(n.code,{children:"limit"})," & ",(0,r.jsx)(n.code,{children:"offset"})]}),"\n",(0,r.jsxs)(n.p,{children:["Pagination is one of those problems that feels solved early in a developer\u2019s career.\n",(0,r.jsx)(n.code,{children:"LIMIT"})," and ",(0,r.jsx)(n.code,{children:"OFFSET"}),' are simple, expressive, and map nicely to the idea of "pages" in a UI.']}),"\n",(0,r.jsx)(n.p,{children:"That is, until your database grows..."}),"\n",(0,r.jsxs)(n.p,{children:["When datasets reach ",(0,r.jsx)(n.strong,{children:"tens or hundreds of millions of rows"}),", offset-based pagination quietly becomes a performance liability \u2014 especially under filtering and sorting. This article explains ",(0,r.jsx)(n.strong,{children:"why that happens"}),", and how ",(0,r.jsx)(n.strong,{children:"cursor-based pagination"})," solves it."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"the-familiar-approach-offset-based-pagination",children:"The Familiar Approach: OFFSET-Based Pagination"}),"\n",(0,r.jsx)(n.p,{children:"Most applications start with queries like this:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT *\nFROM orders\nWHERE status = 'paid'\nORDER BY created_at DESC\nLIMIT 20 OFFSET 0;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Page 1 is fast.\nPage 2 is still fast.\nEverything seems fine \u2014 until users request deeper pages."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"LIMIT 20 OFFSET 500000;\n"})}),"\n",(0,r.jsxs)(n.p,{children:["At scale, this query can become ",(0,r.jsx)(n.strong,{children:"significantly slower"})," than the first page."]}),"\n",(0,r.jsx)(n.p,{children:"This is not accidental. It\u2019s a direct consequence of how databases execute OFFSET."}),"\n",(0,r.jsxs)(n.p,{children:["And no, this problem is not unique to ",(0,r.jsx)(n.code,{children:"RDBMS"}),"s. The exact same ",(0,r.jsx)(n.em,{children:"class of problem"})," exists in many NoSQL systems \u2014 including ",(0,r.jsx)(n.strong,{children:"MongoDB"})," and ",(0,r.jsx)(n.strong,{children:"Elasticsearch"})," \u2014 although it shows up under slightly different names and mechanics."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"why-offset-gets-slower-as-the-page-number-grows",children:"Why OFFSET Gets Slower as the Page Number Grows"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"OFFSET N"})," does ",(0,r.jsx)(n.strong,{children:"not"}),' mean "jump directly to row N".']}),"\n",(0,r.jsx)(n.p,{children:"Internally, most relational databases:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Apply the ",(0,r.jsx)(n.code,{children:"WHERE"})," filter"]}),"\n",(0,r.jsx)(n.li,{children:"Sort the matching rows (or traverse a sorted index)"}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Scan and discard the first N rows"})}),"\n",(0,r.jsxs)(n.li,{children:["Return the next ",(0,r.jsx)(n.code,{children:"LIMIT"})," rows"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"So even though the client only wants 20 rows, the database may need to:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Read ",(0,r.jsx)(n.strong,{children:"hundreds of thousands or millions of rows"})]}),"\n",(0,r.jsx)(n.li,{children:"Throw most of them away"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This means:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Page 1 reads ~20 rows"}),"\n",(0,r.jsx)(n.li,{children:"Page 10,000 reads ~200,000 rows"}),"\n",(0,r.jsx)(n.li,{children:"Page 50,000 reads ~1,000,000 rows"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["The cost grows ",(0,r.jsx)(n.strong,{children:"linearly with the offset"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Even with good indexing, this behavior remains \u2014 the database still has to walk the index entry by entry. That\u2019s why OFFSET-based pagination does not scale well for large datasets."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"the-real-problem-were-asking-the-wrong-question",children:"The Real Problem: We\u2019re Asking the Wrong Question"}),"\n",(0,r.jsx)(n.p,{children:"Offset-based pagination answers this question:"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:'"Give me page number N."'}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"But databases are much better at answering a different question:"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:['"Give me the next rows ',(0,r.jsx)(n.strong,{children:"after this one"}),'."']}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"That shift in thinking leads directly to cursor-based pagination."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"cursor-based-pagination-aka-keyset-pagination",children:"Cursor-Based Pagination (a.k.a. Keyset Pagination)"}),"\n",(0,r.jsxs)(n.p,{children:["Cursor pagination replaces ",(0,r.jsx)(n.code,{children:"OFFSET"})," with a ",(0,r.jsx)(n.strong,{children:"stable, ordered reference point"}),' \u2014 the "cursor".']}),"\n",(0,r.jsxs)(n.p,{children:["Instead of skipping rows, the query continues ",(0,r.jsx)(n.strong,{children:"from the last seen value"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"first-page",children:"First Page"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT *\nFROM orders\nWHERE status = 'paid'\nORDER BY created_at DESC\nLIMIT 20;\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The client stores the last row\u2019s ",(0,r.jsx)(n.code,{children:"created_at"})," value."]}),"\n",(0,r.jsx)(n.h3,{id:"next-page",children:"Next Page"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT *\nFROM orders\nWHERE status = 'paid'\n  AND created_at < '2025-01-01T12:34:56'\nORDER BY created_at DESC\nLIMIT 20;\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The database now performs an ",(0,r.jsx)(n.strong,{children:"index range scan"})," \u2014 no rows are skipped, no work is wasted."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"why-cursor-pagination-scales",children:"Why Cursor Pagination Scales"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"No row skipping"}),"\n",(0,r.jsx)(n.li,{children:"No growing scan cost"}),"\n",(0,r.jsxs)(n.li,{children:["Query time remains ",(0,r.jsx)(n.strong,{children:"constant"})]}),"\n",(0,r.jsx)(n.li,{children:"Perfect alignment with B-tree indexes"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The database always starts exactly where it should."}),"\n",(0,r.jsx)(n.p,{children:"This makes cursor pagination ideal for:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Very large tables"}),"\n",(0,r.jsx)(n.li,{children:"High-traffic APIs"}),"\n",(0,r.jsx)(n.li,{children:'Infinite Scroll or "Load more" experiences'}),"\n",(0,r.jsx)(n.li,{children:"Time-ordered data (events, logs, messages, orders)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"a-perfect-fit-activity-feeds-and-timelines",children:"A Perfect Fit: Activity Feeds and Timelines"}),"\n",(0,r.jsx)(n.p,{children:"Consider a system showing:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"User activity"}),"\n",(0,r.jsx)(n.li,{children:"Audit logs"}),"\n",(0,r.jsx)(n.li,{children:"Notifications"}),"\n",(0,r.jsx)(n.li,{children:"Orders history"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Users:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Always move ",(0,r.jsx)(n.strong,{children:"forward"})]}),"\n",(0,r.jsx)(n.li,{children:"Rarely jump to page 37"}),"\n",(0,r.jsx)(n.li,{children:"Expect consistent performance"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Cursor pagination matches this usage pattern perfectly:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'"Give me the next 20 items"'}),"\n",(0,r.jsx)(n.li,{children:"Stable ordering"}),"\n",(0,r.jsx)(n.li,{children:"Predictable latency"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This is why cursor pagination is used by companies like Twitter, GitHub, Stripe, and Facebook."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"when-cursor-pagination-is-not-a-good-fit",children:["When Cursor Pagination Is ",(0,r.jsx)(n.em,{children:"Not"})," a Good Fit"]}),"\n",(0,r.jsx)(n.p,{children:"Cursor pagination is not a silver bullet. Its trade-offs are real."}),"\n",(0,r.jsx)(n.h3,{id:"1-you-cant-jump-to-arbitrary-pages",children:"1. You Can\u2019t Jump to Arbitrary Pages"}),"\n",(0,r.jsx)(n.p,{children:'There is no "page 42" without walking through the previous cursors.'}),"\n",(0,r.jsx)(n.p,{children:"If your UI requires:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Random page access"}),"\n",(0,r.jsx)(n.li,{children:"Direct navigation to specific page numbers"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"OFFSET may still be necessary (or a hybrid approach)."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"2-requires-a-stable-unique-sort-key",children:"2. Requires a Stable, Unique Sort Key"}),"\n",(0,r.jsx)(n.p,{children:"You need a column (or composite) that is:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Indexed"}),"\n",(0,r.jsx)(n.li,{children:"Immutable"}),"\n",(0,r.jsx)(n.li,{children:"Unambiguous"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Common choices:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"id"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"created_at + id"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"If ordering is unstable, pagination breaks."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"3-more-complex-client-logic",children:"3. More Complex Client Logic"}),"\n",(0,r.jsx)(n.p,{children:"The client must:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Store cursors"}),"\n",(0,r.jsx)(n.li,{children:"Pass them back to the server"}),"\n",(0,r.jsx)(n.li,{children:"Handle edge cases when data changes"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This complexity is manageable \u2014 but it\u2019s not free."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,r.jsx)(n.p,{children:"Offset-based pagination is simple and intuitive \u2014 and perfectly fine for small datasets."}),"\n",(0,r.jsx)(n.p,{children:"But at scale, it becomes increasingly inefficient because the database must scan and discard more rows as offsets grow."}),"\n",(0,r.jsx)(n.p,{children:"Cursor-based pagination flips the model:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Instead of skipping rows, it ",(0,r.jsx)(n.strong,{children:"continues from a known position"})]}),"\n",(0,r.jsx)(n.li,{children:"Performance remains constant"}),"\n",(0,r.jsx)(n.li,{children:"The database does exactly the work required \u2014 no more, no less"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"For large datasets, high traffic, and sequential access patterns, cursor pagination isn\u2019t just an optimization \u2014 it\u2019s the correct architectural choice."}),"\n",(0,r.jsx)(n.p,{children:"And that\u2019s what your interviewer was looking for."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:"If you want, I can:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Add ",(0,r.jsx)(n.strong,{children:"SQL execution plan comparisons"})]}),"\n",(0,r.jsxs)(n.li,{children:["Show ",(0,r.jsx)(n.strong,{children:"composite cursor examples"})]}),"\n",(0,r.jsxs)(n.li,{children:["Rewrite this as a ",(0,r.jsx)(n.strong,{children:"system design interview answer"})]}),"\n",(0,r.jsxs)(n.li,{children:["Or adapt it specifically to ",(0,r.jsx)(n.strong,{children:"PostgreSQL / MySQL / Elasticsearch"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},3546:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>o});var i=s(9729);const r={},a=i.createContext(r);function t(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);