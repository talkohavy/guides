"use strict";(self.webpackChunkdocusaurus_guides=self.webpackChunkdocusaurus_guides||[]).push([[2693],{388:e=>{e.exports=JSON.parse('{"archive":{"blogPosts":[{"id":"vite-library-mode","metadata":{"permalink":"/guides/blog/vite-library-mode","editUrl":"https://github.com/talkohavy/guides/blog/2024-08-10-vite-library-mode.md","source":"@site/blog/2024-08-10-vite-library-mode.md","title":"How to Create a Component Library with Vite","description":"How to create a components library fast using Vite\'s library mode, typescript, css modules, and publish to npm.","date":"2024-08-10T00:00:00.000Z","tags":[{"inline":true,"label":"vite","permalink":"/guides/blog/tags/vite"},{"inline":true,"label":"react","permalink":"/guides/blog/tags/react"},{"inline":true,"label":"typescript","permalink":"/guides/blog/tags/typescript"},{"inline":true,"label":"tutorial","permalink":"/guides/blog/tags/tutorial"}],"readingTime":18.02,"hasTruncateMarker":true,"authors":[{"name":"Tal Kohavy","title":"Full Stack Developer","url":"https://github.com/talkohavy","imageURL":"https://github.com/talkohavy.png","key":"talkohavy","page":null}],"frontMatter":{"title":"How to Create a Component Library with Vite","description":"How to create a components library fast using Vite\'s library mode, typescript, css modules, and publish to npm.","slug":"vite-library-mode","authors":["talkohavy"],"image":"https://i.ibb.co/rGSxHmB/vite.png","tags":["vite","react","typescript","tutorial"],"hide_table_of_contents":false},"unlisted":false,"nextItem":{"title":"Welcome","permalink":"/guides/blog/welcome"}},"content":"## 1. Set up a new Vite project\\n\\nStart a new project:\\n\\n```bash\\nnpm create vite@latest\\n```\\n\\nChoose `React` & `TypeScript + SWC`\\n\\nHere are 4 things I recommend you to do right after installing Vite:\\n\\n1. Early first commit\\n   Committing regularly is a very good habit. And there is one point in time where it is especially helpful, right after you created a new project and BEFORE you type the first character in your project.\\n\\n2. Install node\'s types\\n   If working with TypeScript I also install the types package for node. Sooner or later you will need this.\\n\\n   ```bash\\n   pnpm add -D @types/node\\n   ```\\n\\n---\\n\\n## 2. Create a `lib/main.ts` file\\n\\nCreate a folder next to `src` and name it `lib`. Inside, create the file which will act as the main entry point of your library, and name it `main.ts`. When installing the library you can import everything that is exported from this file.\\n\\n```diff\\n \ud83d\udcc2 my-component-library\\n// diff-add-start\\n\u2523 \ud83d\udcc2 lib\\n\u2503 \u2517 \ud83d\udcdc main.ts\\n// diff-add-end\\n  \u2523 \ud83d\udcc2 public\\n  \u2523 \ud83d\udcc2 src\\n  \u2026\\n```\\n\\n## 3. Activate Vite\'s Library Mode\\n\\nBy default, when running `vite build`, Vite will transpile the code inside `src` to the `dist` folder. What we want instead, is to transpile and ship the code inside of `lib`.\\n\\nTo activate vite\'s library mode, inside of our `vite.config.ts` file, we will need to use the `build.lib` option.\\n\\nLike so (do not copy code yet!):\\n\\n```jsx showLineNumbers\\n// diff-add-next-line\\nimport { resolve } from \'path\'\\nimport { defineConfig } from \'vite\'\\nimport react from \'@vitejs/plugin-react-swc\'\\n\\nexport default defineConfig({\\n  plugins: [react()],\\n// diff-add-start\\n  build: {\\n    lib: {\\n      entry: resolve(__dirname, \'lib/main.ts\'),\\n      formats: [\'es\']\\n    }\\n  }\\n// diff-add-end\\n})\\n```\\n\\n\x3c!-- truncate --\x3e\\n\\n## 4. tsconfig.json dedicated for build\\n\\nUpdate the contents of your `tsconfig.json` file like so:\\n\\n```json title=tsconfig.json\\n{\\n  \\"files\\": [],\\n  \\"references\\": [\\n    { \\"path\\": \\"./tsconfig.app.json\\" },\\n    { \\"path\\": \\"./tsconfig.node.json\\" },\\n// diff-add-next-line\\n    { \\"path\\": \\"./tsconfig.build.json\\" }\\n  ]\\n}\\n```\\n\\nAnd create a new `tsconfig.json`:\\n\\n```diff\\n \ud83d\udcc2my-component-library\\n  \u2523 ...\\n  \u2523 \ud83d\udcdctsconfig.json\\n// diff-add-next-line\\n\u2523 \ud83d\udcdctsconfig.build.json\\n  ...\\n```\\n\\nAnd paste the below code as its contents:\\n\\n```json title=tsconfig.build.ts\\n{\\n  \\"extends\\": \\"./tsconfig.json\\",\\n  \\"compilerOptions\\": {\\n    // -------------------\\n    // Section 1: Projects\\n    // -------------------\\n    // \\"composite\\": true, // Enable constraints that allow a TypeScript project to be used with project references.\\n    // \\"incremental\\": true, // Save .tsbuildinfo files to allow for incremental compilation of projects.\\n    // \\"tsBuildInfoFile\\": \\"./node_modules/.tmp/tsconfig.app.tsbuildinfo\\", // Specify the path to .tsbuildinfo incremental compilation file.\\n    // \\"disableSourceOfProjectReferenceRedirect\\": true,  // Disable preferring source files instead of declaration files when referencing composite projects.\\n    // \\"disableSolutionSearching\\": true,                 // Opt a project out of multi-project reference checking when editing.\\n    // \\"disableReferencedProjectLoad\\": true,             // Reduce the number of projects loaded automatically by TypeScript.\\n\\n    // -----------------------------------\\n    // Section 2: Language and Environment\\n    // -----------------------------------\\n    \\"target\\": \\"ESNext\\",\\n    \\"jsx\\": \\"react-jsx\\", // Specify what JSX code is generated.\\n    \\"lib\\": [\\"ESNext\\", \\"DOM\\", \\"DOM.Iterable\\"], // adding the \\"DOM\\" library helps vs-code to recognize the window & document objects. Specify a set of bundled library declaration files that describe the target runtime environment.\\n    \\"useDefineForClassFields\\": true, // Emit ECMAScript-standard-compliant class fields.\\n    \\"moduleDetection\\": \\"force\\", // <--- defaults to `auto`. Control what method is used to detect module-format JS files.\\n    // \\"experimentalDecorators\\": true,                   // Enable experimental support for legacy experimental decorators.\\n    // \\"emitDecoratorMetadata\\": true,                    // Emit design-type metadata for decorated declarations in source files.\\n    // \\"jsxFactory\\": \\"\\",                                 // Specify the JSX factory function used when targeting React JSX emit, e.g. \'React.createElement\' or \'h\'.\\n    // \\"jsxFragmentFactory\\": \\"\\",                         // Specify the JSX Fragment reference used for fragments when targeting React JSX emit e.g. \'React.Fragment\' or \'Fragment\'.\\n    // \\"jsxImportSource\\": \\"\\",                            // Specify module specifier used to import the JSX factory functions when using \'jsx: react-jsx*\'.\\n    // \\"reactNamespace\\": \\"\\",                             // Specify the object invoked for \'createElement\'. This only applies when targeting \'react\' JSX emit.\\n    // \\"noLib\\": true,                                    // Disable including any library files, including the default lib.d.ts.\\n\\n    // ------------------\\n    // Section 3: Modules\\n    // ------------------\\n    \\"module\\": \\"ESNext\\", // <--- defaults to `commonjs`. Specify what module code is generated.\\n    \\"moduleResolution\\": \\"Bundler\\", // Specify how TypeScript looks up a file from a given module specifier.\\n    \\"resolveJsonModule\\": true,\\n    \\"allowImportingTsExtensions\\": true, // Option \'allowImportingTsExtensions\' can only be used when either \'noEmit\' or \'emitDeclarationOnly\' is set.ts\\n    \\"baseUrl\\": \\"./\\", // Specify the base directory to resolve non-relative module names.\\n    \\"typeRoots\\": [\\"node_modules/@types\\"], // Specify multiple folders that act like \'./node_modules/@types\'.\\n    \\"paths\\": {\\n      \\"/*\\": [\\"src/public/*\\"],\\n      \\"@src/*\\": [\\"src/*\\"]\\n    },\\n    // \\"rootDirs\\": [],                                   /* Allow multiple folders to be treated as one when resolving modules. */\\n    // \\"types\\": [],                                      /* Specify type package names to be included without being referenced in a source file. */\\n    // \\"allowUmdGlobalAccess\\": true,                     /* Allow accessing UMD globals from modules. */\\n    // \\"moduleSuffixes\\": [],                             /* List of file name suffixes to search when resolving a module. */\\n    // \\"allowImportingTsExtensions\\": true,               /* Allow imports to include TypeScript file extensions. Requires \'--moduleResolution bundler\' and either \'--noEmit\' or \'--emitDeclarationOnly\' to be set. */\\n    // \\"resolvePackageJsonExports\\": true,                /* Use the package.json \'exports\' field when resolving package imports. */\\n    // \\"resolvePackageJsonImports\\": true,                /* Use the package.json \'imports\' field when resolving imports. */\\n    // \\"customConditions\\": [],                           /* Conditions to set in addition to the resolver-specific defaults when resolving imports. */\\n    // \\"resolveJsonModule\\": true,                        /* Enable importing .json files. */\\n    // \\"allowArbitraryExtensions\\": true,                 /* Enable importing files with any extension, provided a declaration file is present. */\\n    // \\"noResolve\\": true,                                /* Disallow \'import\'s, \'require\'s or \'<reference>\'s from expanding the number of files TypeScript should add to a project. */\\n\\n    // -----------------------------\\n    // Section 4: JavaScript Support\\n    // -----------------------------\\n    \\"checkJs\\": true, // without it? this config file would not apply to js/jsx files. Enable error reporting in type-checked JavaScript files.\\n    \\"maxNodeModuleJsDepth\\": 0, // Specify the maximum folder depth used for checking JavaScript files from \'node_modules\'. Only applicable with \'allowJs\'.\\n    // \\"allowJs\\": true,                                  /* Allow JavaScript files to be a part of your program. Use the \'checkJS\' option to get errors from these files. */\\n\\n    // ---------------\\n    // Section 5: Emit\\n    // ---------------\\n    \\"noEmit\\": false, // set to `true` to disable emitting files from a compilation.\\n    \\"outDir\\": \\"./dist\\", // Specify an output folder for all emitted files.\\n    \\"declaration\\": true, // Generate .d.ts files from TypeScript and JavaScript files in your project.\\n    \\"emitDeclarationOnly\\": true, // Only output d.ts files and not JavaScript files\\n    // \\"sourceMap\\": true, // defaults to `false`. Create source map files for emitted JavaScript files.\\n    // \\"declarationMap\\": true, // Create sourcemaps for d.ts files.\\n    // \\"inlineSourceMap\\": true, // Include sourcemap files inside the emitted JavaScript. */\\n    // \\"outFile\\": \\"./\\", // Specify a file that bundles all outputs into one JavaScript file. If \'declaration\' is true, also designates a file that bundles all .d.ts output. */\\n    // \\"removeComments\\": true, // Disable emitting comments.\\n    // \\"importHelpers\\": true, // Allow importing helper functions from tslib once per project, instead of including them per-file.\\n    // \\"downlevelIteration\\": true, // Emit more compliant, but verbose and less performant JavaScript for iteration.\\n    // \\"sourceRoot\\": \\"\\", // Specify the root path for debuggers to find the reference source code.\\n    // \\"mapRoot\\": \\"\\", // Specify the location where debugger should locate map files instead of generated locations.\\n    // \\"inlineSources\\": true, // Include source code in the sourcemaps inside the emitted JavaScript.\\n    // \\"emitBOM\\": true, // Emit a UTF-8 Byte Order Mark (BOM) in the beginning of output files.\\n    // \\"newLine\\": \\"crlf\\", // Set the newline character for emitting files.\\n    // \\"stripInternal\\": true, // Disable emitting declarations that have \'@internal\' in their JSDoc comments.\\n    // \\"noEmitHelpers\\": true, // Disable generating custom helper functions like \'__extends\' in compiled output.\\n    // \\"noEmitOnError\\": true, // Disable emitting files if any type checking errors are reported.\\n    // \\"preserveConstEnums\\": true, // Disable erasing \'const enum\' declarations in generated code.\\n    // \\"declarationDir\\": \\"./\\", // Specify the output directory for generated declaration files.\\n\\n    // ------------------------------\\n    // Section 6: Interop Constraints\\n    // ------------------------------\\n    \\"isolatedModules\\": true, // <--- Setting to `true` tells TypeScript to warn you if you write certain code that can\'t be correctly interpreted by a single-file transpilation process. Ensure that each file can be safely transpiled without relying on other imports.\\n    \\"esModuleInterop\\": true, // Emit additional JavaScript to ease support for importing CommonJS modules. This enables \'allowSyntheticDefaultImports\' for type compatibility.\\n    \\"allowSyntheticDefaultImports\\": true, // Allow \'import x from y\' when a module doesn\'t have a default export.\\n    \\"forceConsistentCasingInFileNames\\": true, // Ensure that casing is correct in imports.\\n    // \\"preserveSymlinks\\": true, // <--- Solved being redirected to node_modules/.pnpm symlink all the time! Disable resolving symlinks to their realpath. This correlates to the same flag in node. But on the other-hand, I wasn\'t able to import Page as type from playwright in jsdoc. Disable resolving symlinks to their realpath. This correlates to the same flag in node.\\n    // \\"verbatimModuleSyntax\\": true,                     /* Do not transform or elide any imports or exports not marked as type-only, ensuring they are written in the output file\'s format based on the \'module\' setting. */\\n    // \\"isolatedDeclarations\\": true,                     /* Require sufficient annotation on exports so other tools can trivially generate declaration files. */\\n\\n    // ------------------------\\n    // Section 7: Type Checking\\n    // ------------------------\\n    /* Linting */\\n    // \\"strictNullChecks\\": true,                         // <--- When type checking, take into account \'null\' and \'undefined\'.\\n    // \\"strictFunctionTypes\\": true,                      // <--- When assigning functions, check to ensure parameters and the return values are subtype-compatible.\\n    // \\"strictBindCallApply\\": true,                      // <--- Check that the arguments for \'bind\', \'call\', and \'apply\' methods match the original function.\\n    // \\"strictPropertyInitialization\\": true,             // <--- Check for class properties that are declared but not set in the constructor.\\n    \\"strict\\": true, // <--- Enable all strict type-checking options.\\n    \\"noImplicitAny\\": true, // <--- Enable error reporting for expressions and declarations with an implied \'any\' type.\\n    \\"noImplicitThis\\": true, // <---Enable error reporting when \'this\' is given the type \'any\'.\\n    \\"useUnknownInCatchVariables\\": true, // <--- Default catch clause variables as \'unknown\' instead of \'any\'.\\n    \\"alwaysStrict\\": true, // <--- Ensure \'use strict\' is always emitted.\\n    \\"noUnusedLocals\\": true, // <--- Enable error reporting when local variables aren\'t read.\\n    \\"noUnusedParameters\\": true, // <--- Raise an error when a function parameter isn\'t read.\\n    \\"exactOptionalPropertyTypes\\": false, // <--- Interpret optional property types as written, rather than adding \'undefined\'.\\n    \\"noImplicitReturns\\": true, // <--- Enable error reporting for codepaths that do not explicitly return in a function.\\n    \\"noFallthroughCasesInSwitch\\": true, // <--- Enable error reporting for fallthrough cases in switch statements.\\n    \\"noUncheckedIndexedAccess\\": true, // <--- Add \'undefined\' to a type when accessed using an index.\\n    \\"noImplicitOverride\\": true, // <--- Ensure overriding members in derived classes are marked with an override modifier.\\n    \\"noPropertyAccessFromIndexSignature\\": false, // <--- settings this to true marks obj[\'firstName\'] as an error, and recommends obj.firstName instead. Enforces using indexed accessors for keys declared using an indexed type.\\n    \\"allowUnusedLabels\\": false, // <--- Disable error reporting for unused labels.\\n    // \\"allowUnreachableCode\\": true,                     // <--- Disable error reporting for unreachable code.\\n\\n    // -----------------------\\n    // Section 8: Completeness\\n    // -----------------------\\n    \\"skipLibCheck\\": true // Skip type checking all .d.ts files.\\n    // \\"skipDefaultLibCheck\\": true,                      /* Skip type checking .d.ts files that are included with TypeScript. */\\n  },\\n  \\"include\\": [\\"lib\\"]\\n}\\n```\\n\\nThe important part to notice is that the \\"include\\" key of it has the value of [\\"lib\\"], to have our typescript rules be applied only to the `lib` folder, and not the `src`.\\n\\nImplementing this separate configuration helps avoid TypeScript errors when you import components directly from the `dist` folder on the demo page and those components haven\'t been built yet.\\n\\n## 5. Use the tsconfig.build.ts for building\\n\\nTo use `tsconfig.build.json` for building you need to pass the configuration file to `tsc` in the build script in your package.json:\\n\\n```json\\n{\\n  // ...\\n  \\"scripts\\": {\\n     ...\\n// diff-remove-next-line\\n  \\"build\\": \\"tsc && vite build\\",\\n// diff-add-next-line\\n  \\"build\\": \\"tsc -p ./tsconfig.build.json && vite build\\",\\n  }\\n}\\n```\\n\\n## 6. Copy `vite-env.d.ts` from `src` to `lib`\\n\\nYou will also need to copy the file `vite-env.d.ts` from `src` to `lib`. Without this file Typescript will miss some types definitions provided by Vite when building (because we don\'t include `src` in our `tsconfig.build.ts`).\\n\\n## 7. Set `emptyOutDir` to `false`\\n\\nBy default, vite empties the output directory.\\n\\nThis _would_ have been a good behavior, if we weren\'t using types being compiled with typescript.\\n\\nSee, what happens now is that typescript creates types (just the types), puts them inside the `dist` folder, and then comes along vite and deletes them. We want to cancel that behavior:\\n\\n```tsx title=cite.config.ts\\nimport { defineConfig } from \'vite\';\\n\\nexport default defineConfig({\\n  build: {\\n    // ...\\n    emptyOutDir: false, // <--- defaults to `true`\\n  },\\n});\\n```\\n\\nYou can now execute `npm run build` and this is what you will see in your `dist` folder:\\n\\n```bash\\n \ud83d\udcc2dist\\n  \u2523 \ud83d\udcdcmy-component-library.js\\n  \u2523 \ud83d\udcdcmain.d.ts\\n  \u2523 \ud83d\udcdcmain.js\\n  \u2517 \ud83d\udcdcvite.svg\\n```\\n\\n:::info\\n\ud83d\udca1 The name of the output file is identical with the `name` property in your package.json per default. This can be changed in the Vite config (`build.lib.fileName`) but we will do something else about this later.\\n:::\\n\\n## 8. Get rid of the `vite.svg` file\\n\\nThe file `vite.svg` is in your `dist` folder because Vite copies all files from the `public` directory to the output folder. Let\'s disable this behavior:\\n\\n```tsx showLineNumbers\\nexport default defineConfig({\\n  // ...\\n  build: {\\n// diff-add-next-line\\n    copyPublicDir: false,\\n  },\\n});\\n```\\n\\n## 9. Create a basic component\\n\\nWhat is a React component library without components?  \\nLet\'s create one or two:\\n\\n```bash\\n \ud83d\udcc2 my-component-library\\n  \u2523 \ud83d\udcc2 lib\\n +\u2503 \u2523 \ud83d\udcc2 components\\n +\u2503 \u2503 \u2523 \ud83d\udcc2 Button\\n +\u2503 \u2503 \u2503 \u2523 \ud83d\udcc2 Button.tsx\\n +\u2503 \u2503 \u2503 \u2517 \ud83d\udcdc index.ts\\n +\u2503 \u2503 \u2517 \ud83d\udcc2 Label\\n +\u2503 \u2503 \u2503 \u2523 \ud83d\udcc2 Label.tsx\\n +\u2503 \u2503   \u2517 \ud83d\udcdc index.ts\\n  \u2503 \u2517 \ud83d\udcdc main.ts\\n  \u2026\\n```\\n\\nAnd add a very basic implementation for these components:\\n\\n```tsx title=lib/components/Button/Button.tsx\\nexport default function Button(props: React.ButtonHTMLAttributes<HTMLButtonElement>) {\\n  return <button type=\'button\' {...props} />;\\n}\\n```\\n\\n```tsx title=lib/components/Label/Label.tsx\\nexport default function Label(props: React.LabelHTMLAttributes<HTMLLabelElement>) {\\n  return <label {...props} />;\\n}\\n```\\n\\nFinally export the components from the library\'s main file:\\n\\n```tsx title=lib/main.ts\\nexport { default as Button } from \'./components/Button\';\\nexport { default as Label } from \'./components/Label\';\\n```\\n\\nIf you `npm run build` again you will notice that the transpiled file `my-component-library.js` now has **78kb** \ud83d\ude2e\\n\\n## 10. Remove `react` & `react/jsx-runtime` from the bundle\\n\\nThe implementation of the components above contains React JSX code and therefore `react` (and `react/jsx-runtime`) gets bundled as well. As this library will be used in projects that have React installed anyways, you can **externalize** this dependencies to _remove the code from bundle_:\\n\\n```tsx title=vite.config.ts\\nexport default defineConfig({\\n  // ...\\n  build: {\\n   // ...\\n// diff-add-start\\n   rollupOptions: {\\n       external: [\'react\', \'react/jsx-runtime\'],\\n   },\\n// diff-add-end\\n  },\\n});\\n```\\n\\nNow take a look at your `package.json` file under `dependencies` key. Right now there should be only two there: `react` and `react-dom` You can move both to the `devDependencies`. Additionally, add them as `peerDependencies`, so that the consuming application is aware that it must have React installed to use this package.\\n\\n```json title=package.json\\n{\\n// diff-remove-next-line\\n\\"dependencies\\": {\\n  // diff-add-next-line\\n\\"peerDependencies\\": {\\n  \\"react\\": \\"^18.2.0\\",\\n    \\"react-dom\\": \\"^18.2.0\\"\\n  },\\n  \\"devDependencies\\": {\\n// diff-add-start\\n\\"react\\": \\"^18.2.0\\",\\n\\"react-dom\\": \\"^18.2.0\\",\\n// diff-add-end\\n  }\\n}\\n```\\n\\n## 11. Handle CSS files\\n\\nThis library will use **CSS modules** to style the components.\\n\\nCSS modules are supported by Vite by default. All you have to do is to create CSS files that end with `.module.css` (or `.module.scss`).\\n\\n```bash\\n \ud83d\udcc2my-component-library\\n  \u2523 \ud83d\udcc2lib\\n  \u2503 \u2523 \ud83d\udcc2components\\n  \u2503 \u2503 \u2523 \ud83d\udcc2Button\\n  \u2503 \u2503 \u2503 \u2523 \ud83d\udcc2Button.tsx\\n  \u2503 \u2503 \u2503 \u2523 \ud83d\udcdcindex.ts\\n+ \u2503 \u2503 \u2503 \u2517 \ud83d\udcc2Button.module.scss\\n  \u2503 \u2503 \u2517 \ud83d\udcc2Label\\n  \u2503 \u2503   \u2523 \ud83d\udcc2Label.tsx\\n  \u2503 \u2503   \u2523 \ud83d\udcdcindex.ts\\n+ \u2503 \u2503   \u2517 \ud83d\udcc2Label.module.scss\\n  \u2503 \u2517 \ud83d\udcdcmain.ts\\n  \u2026\\n```\\n\\nAnd add some basic CSS classes:\\n\\n```css title=lib/components/Button/Button.module.scss\\n.button {\\n    padding: 1rem;\\n}\\n```\\n\\n```css title=lib/components/Label/Label.module.scss\\n.label {\\n    font-weight: bold;\\n}\\n```\\n\\nAnd import/use them inside your components:\\n\\n```tsx\\nimport styles from \'./Button.module.scss\';\\n\\nexport function Button(props: React.ButtonHTMLAttributes<HTMLButtonElement>) {\\n  const { className, ...restProps } = props;\\n  return <button type=\'button\' className={`${className} ${styles.button}`} {...restProps} />;\\n}\\n```\\n\\nIf you choose to use `.scss` instead of `.css` files, you\'ll need `sass`:\\n\\n```bash\\npnpm add -D sass\\n```\\n\\nSo now, after transpiling your library you will notice that there is a new file in your distribution folder:\\n\\n```bash\\n \ud83d\udcc2dist\\n  \u2523 \u2026\\n  \u2523 \ud83d\udcdcmy-component-library.js\\n# diff-add-next-line\\n\u2517 \ud83d\udcdcstyle.css\\n```\\n\\nBut there are two issues with this file:\\n\\n1. You need to manually import the file in the consuming application.\\n2. It is one big giant file that contains all styles for all components.\\n\\nCSS files just can\'t easily be imported in JavaScript. Therefore, the CSS file is generated separately, allowing the library user to decide how to handle the file.\\n\\nBut what if we were to assume that the application using the library has a bundler configuration that can handle CSS imports?\\n\\nFor this to work, the transpiled JavaScript bundle must contain an import statement for the CSS file. We are going to use yet another Vite plugin ([vite-plugin-lib-inject-css](https://github.com/emosheeep/vite-plugin-lib-inject-css)) that does exactly what we need with zero configuration.\\n\\n:::tip\\n**From their documentation:**\\n\\n\\"Inject css at the top of each chunk file in library mode using import statement, support multi-entries build, especially to help building component libraries.\\"\\n:::\\n\\nLet\'s install `vite-plugin-lib-inject-css`:\\n\\n```bash\\npnpm add -D vite-plugin-lib-inject-css\\n```\\n\\nAnd use it inside our `vite.config.ts` file:\\n\\n```tsx title=vite.config.ts\\n// diff-add-next-line\\nimport { libInjectCss } from \'vite-plugin-lib-inject-css\';\\n\\nexport default defineConfig({\\n  // ...\\n  plugins: [\\n    react(),\\n// diff-add-next-line\\n  libInjectCss(),\\n  ],\\n  // ...\\n});\\n```\\n\\nBuild the library and take a look at the top of your bundled JavaScript file (`dist/my-component-library.js`):\\n\\n```tsx title=dist/my-component-library.js\\nimport \'./main.css\';\\n\\n// ...\\n```\\n\\n:::info\\n\ud83d\udca1 You may notice that the CSS filename has changed from style.css to main.css. This change occurs because the plugin generates a separate CSS file for each chunk, and in this case the name of the chunk comes from the filename of the entry file.\\n:::\\n\\n## 12. Split up the CSS\\n\\nBut there\'s still the second problem: when you import something from your library, `main.css` is also imported and all the CSS styles end up in your application bundle. Even if you only import the **Button**.\\n\\nWell, good news!!! The `libInjectCSS` plugin generates a separate CSS file for each chunk and includes an import statement at the beginning of each chunk\'s output file. So if you split up the JavaScript code, you\'ll end up having separate CSS files that only get imported when the according JavaScript files are imported.\\n\\nBest way of doing this would be to turn every file into an Rollup entry point. And there is a recommended way of doing this right in the [Rollup documentation](https://rollupjs.org/configuration-options/#input):\\n\\nSo let\'s add this to your configuration.\\n\\nFirst install `glob` as it will be required:\\n\\n```bash\\npnpm add -D glob\\n```\\n\\nThen change your Vite config to this:\\n\\n```tsx title=vite.config.ts\\n/* eslint-disable*/\\n// diff-remove-next-line\\nimport { resolve } from \'path\';\\n// diff-add-start\\nimport { extname, relative, resolve } from \'path\';\\nimport { glob } from \'glob\';\\nimport { fileURLToPath } from \'node:url\';\\n// diff-add-end\\n// ...\\nexport default defineConfig({\\n  // ...\\n    rollupOptions: {\\n      external: [\'react\', \'react/jsx-runtime\'],\\n// diff-add-start\\n     input: Object.fromEntries(\\n         glob.sync(\'lib/**/*.{ts,tsx}\', {\\n             ignore: [\'lib/**/*.d.ts\'],\\n       }).map(file => [\\n         // The name of the entry point lib/nested/foo.ts becomes nested/foo\\n         relative(\\n             \'lib\',\\n           file.slice(0, file.length - extname(file).length),\\n         ),\\n         // The absolute path to the entry file lib/nested/foo.ts becomes /project/lib/nested/foo.ts\\n         fileURLToPath(new URL(file, import.meta.url)),\\n       ]),\\n     ),\\n// diff-add-end\\n    },\\n   // ...\\n});\\n```\\n\\n:::info\\n\ud83d\udca1 The glob library helps you to specify a set of filenames. In this case it selects all files ending with `.ts` or `.tsx` and ignores `*.d.ts` files.\\n:::\\n\\n**How to use Storybook for my library?**\\n\\nTo install Storybook run `npx storybook@latest init` and start adding your stories.\\n\\nIf you add stories inside the `lib` folder you also need to make sure to exclude all `.stories.tsx` files from the glob pattern so the stories don\'t end up in your bundle.\\n\\n```tsx\\nglob.sync(\'lib/**/*.{ts,tsx}\', {\\n  // diff-remove-next-line\\n  ignore: [\'lib/**/*.d.ts\'],\\n// diff-add-next-line\\n  ignore: [\'lib/**/*.d.ts\', \'lib/**/*.stories.tsx\'],\\n});\\n```\\n\\nNow you end up with a bunch of JavaScript and CSS files in the root of your `dist` folder. It works, but it doesn\'t look particularly pretty, does it?\\n\\nThat\'s why we\'ll add `rollupOptions.output` to our config:\\n\\n```tsx title=vite.config.ts\\nexport default defineConfig({\\n\\n  rollupOptions: {\\n    // ...\\n// diff-add-start\\n     output: {\\n       assetFileNames: \'assets/[name][extname]\',\\n       entryFileNames: \'[name].js\',\\n     },\\n// diff-add-end\\n    },\\n    // ...\\n});\\n```\\n\\nTranspile the library again and all JavaScript files should now be in the same organized folder structure you have created in `lib` alongside with their type definitions. And the CSS files are inside a new folder called assets. \ud83d\ude4c\\n\\nNotice that the name of the main file has changed from \\"my-component-library.js\\" to \\"main.js\\". That\'s great!\\n\\n## 13. Update your `package.json` file\\n\\nmain & types should be `dist/main.js` and `dist/main.d.ts`.\\n\\nYour library\'s primary entry point is now located at `dist/main.js`, so this needs to be set in your `package.json`.\\n\\nThe same applies to the types\' entry point: `dist/main.d.ts`\\n\\n```json title=package.json\\n{\\n  \\"name\\": \\"my-component-library\\",\\n  \\"private\\": true,\\n  \\"version\\": \\"0.0.0\\",\\n  \\"type\\": \\"module\\",\\n// highlight-start\\n  \\"main\\": \\"dist/main.js\\",\\n  \\"types\\": \\"dist/main.d.ts\\",\\n// highlight-end\\n}\\n```\\n\\n## 14. Add CSS to Side effects\\n\\nTo prevent the CSS files from being accidentally removed by the consumer\'s tree-shaking efforts, you should also specify the generated CSS as side effects:\\n\\n```json title=package.json\\n{\\n// ...\\n// diff-add-next-line\\n\\"sideEffects\\": [\\"**/*.css\\"],\\n// ...\\n}\\n```\\n\\n## 15. Use `prepublishOnly` to ensure build prior to publish\\n\\nYou can use the special lifecycle script `prepublishOnly` to guarantee that your changes are always built before the package is published:\\n\\n```json title=package.json\\n{\\n  \\"scripts\\": {\\n    \\"dev\\": \\"vite\\",\\n    \\"build\\": \\"tsc && vite build\\",\\n    // ...\\n// diff-add-next-line\\n  \\"prepublishOnly\\": \\"npm run build\\"\\n  },\\n}\\n```\\n\\n## 16. Demo page\\n\\nTo just play around with your components on the demo page, you can simply import the components directly from the root of your project. This works because your `package.json` points to the transpiled main file `dist/main.ts`.\\n\\n```tsx title=src/App.tsx\\n/* eslint-disable */\\nimport { Button, Input, Label } from \'../\';\\n\\n// ...\\n```"},{"id":"welcome","metadata":{"permalink":"/guides/blog/welcome","editUrl":"https://github.com/talkohavy/guides/blog/2021-08-26-welcome/index.md","source":"@site/blog/2021-08-26-welcome/index.md","title":"Welcome","description":"Docusaurus blogging features are powered by the blog plugin.","date":"2021-08-26T00:00:00.000Z","tags":[{"inline":true,"label":"facebook","permalink":"/guides/blog/tags/facebook"},{"inline":true,"label":"hello","permalink":"/guides/blog/tags/hello"},{"inline":true,"label":"docusaurus","permalink":"/guides/blog/tags/docusaurus"}],"readingTime":0.42,"hasTruncateMarker":true,"authors":[{"name":"S\xe9bastien Lorber","title":"Docusaurus maintainer","url":"https://sebastienlorber.com","imageURL":"https://github.com/slorber.png","key":"slorber","page":null},{"name":"Yangshun Tay","title":"Front End Engineer @ Facebook","url":"https://github.com/yangshun","imageURL":"https://github.com/yangshun.png","key":"yangshun","page":null}],"frontMatter":{"slug":"welcome","title":"Welcome","authors":["slorber","yangshun"],"tags":["facebook","hello","docusaurus"]},"unlisted":false,"prevItem":{"title":"How to Create a Component Library with Vite","permalink":"/guides/blog/vite-library-mode"},"nextItem":{"title":"MDX Blog Post","permalink":"/guides/blog/mdx-blog-post"}},"content":"[Docusaurus blogging features](https://docusaurus.io/docs/blog) are powered by the [blog plugin](https://docusaurus.io/docs/api/plugins/@docusaurus/plugin-content-blog).\\n\\nSimply add Markdown files (or folders) to the `blog` directory.\\n\\nRegular blog authors can be added to `authors.yml`.\\n\\nThe blog post date can be extracted from filenames, such as:\\n\\n- `2019-05-30-welcome.md`\\n- `2019-05-30-welcome/index.md`\\n\\nA blog post folder can be convenient to co-locate blog post images:\\n\\n![Docusaurus Plushie](./docusaurus-plushie-banner.jpeg)\\n\\nThe blog supports tags as well!\\n\\n**And if you don\'t want a blog**: just delete this directory, and use `blog: false` in your Docusaurus config.\\n\\n\x3c!-- truncate --\x3e"},{"id":"mdx-blog-post","metadata":{"permalink":"/guides/blog/mdx-blog-post","editUrl":"https://github.com/talkohavy/guides/blog/2021-08-01-mdx-blog-post.mdx","source":"@site/blog/2021-08-01-mdx-blog-post.mdx","title":"MDX Blog Post","description":"Blog posts support Docusaurus Markdown features, such as MDX.","date":"2021-08-01T00:00:00.000Z","tags":[{"inline":true,"label":"docusaurus","permalink":"/guides/blog/tags/docusaurus"}],"readingTime":0.19,"hasTruncateMarker":true,"authors":[{"name":"S\xe9bastien Lorber","title":"Docusaurus maintainer","url":"https://sebastienlorber.com","imageURL":"https://github.com/slorber.png","key":"slorber","page":null}],"frontMatter":{"slug":"mdx-blog-post","title":"MDX Blog Post","authors":["slorber"],"tags":["docusaurus"]},"unlisted":false,"prevItem":{"title":"Welcome","permalink":"/guides/blog/welcome"},"nextItem":{"title":"Greetings!","permalink":"/guides/blog/greetings"}},"content":"Blog posts support [Docusaurus Markdown features](https://docusaurus.io/docs/markdown-features), such as [MDX](https://mdxjs.com/).\\n\\n:::tip\\n\\nUse the power of React to create interactive blog posts.\\n\\n```js\\n<button onClick={() => alert(\'button clicked!\')}>Click me!</button>\\n```\\n\\n<button onClick={() => alert(\'button clicked!\')}>Click me!</button>\\n\\n:::\\n\\n\x3c!-- truncate --\x3e"},{"id":"greetings","metadata":{"permalink":"/guides/blog/greetings","editUrl":"https://github.com/talkohavy/guides/blog/2021-02-28-greetings.md","source":"@site/blog/2021-02-28-greetings.md","title":"Greetings!","description":"Congratulations, you have made your first post!","date":"2021-02-28T00:00:00.000Z","tags":[{"inline":true,"label":"greetings","permalink":"/guides/blog/tags/greetings"}],"readingTime":0.115,"hasTruncateMarker":true,"authors":[{"name":"Joel Marcy","title":"Co-creator of Docusaurus 1","url":"https://github.com/JoelMarcey","imageURL":"https://github.com/JoelMarcey.png","key":"joel_marcy","page":null},{"name":"Sebastian Lor","title":"Docusaurus maintainer","url":"https://sebastienlorber.com","imageURL":"https://github.com/slorber.png","key":"sebastian_lor","page":null}],"frontMatter":{"slug":"greetings","title":"Greetings!","authors":["joel_marcy","sebastian_lor"],"tags":["greetings"]},"unlisted":false,"prevItem":{"title":"MDX Blog Post","permalink":"/guides/blog/mdx-blog-post"},"nextItem":{"title":"Long Blog Post","permalink":"/guides/blog/long-blog-post"}},"content":"Congratulations, you have made your first post!\\n\\nFeel free to play around and edit this post as much you like.\\n\\n\x3c!-- truncate --\x3e"},{"id":"long-blog-post","metadata":{"permalink":"/guides/blog/long-blog-post","editUrl":"https://github.com/talkohavy/guides/blog/2019-05-29-long-blog-post.md","source":"@site/blog/2019-05-29-long-blog-post.md","title":"Long Blog Post","description":"This is the summary of a very long blog post,","date":"2019-05-29T00:00:00.000Z","tags":[{"inline":true,"label":"hello","permalink":"/guides/blog/tags/hello"},{"inline":true,"label":"docusaurus","permalink":"/guides/blog/tags/docusaurus"}],"readingTime":2.05,"hasTruncateMarker":true,"authors":[{"name":"Endilie Yacop Sucipto","title":"Maintainer of Docusaurus","url":"https://github.com/endiliey","imageURL":"https://github.com/endiliey.png","key":"endi","page":null}],"frontMatter":{"slug":"long-blog-post","title":"Long Blog Post","authors":"endi","tags":["hello","docusaurus"]},"unlisted":false,"prevItem":{"title":"Greetings!","permalink":"/guides/blog/greetings"},"nextItem":{"title":"First Blog Post","permalink":"/guides/blog/first-blog-post"}},"content":"This is the summary of a very long blog post,\\n\\nUse a `\x3c!--` `truncate` `--\x3e` comment to limit blog post size in the list view.\\n\\n\x3c!--truncate--\x3e\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet"},{"id":"first-blog-post","metadata":{"permalink":"/guides/blog/first-blog-post","editUrl":"https://github.com/talkohavy/guides/blog/2019-05-28-first-blog-post.md","source":"@site/blog/2019-05-28-first-blog-post.md","title":"First Blog Post","description":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet","date":"2019-05-28T00:00:00.000Z","tags":[{"inline":true,"label":"hola","permalink":"/guides/blog/tags/hola"},{"inline":true,"label":"docusaurus","permalink":"/guides/blog/tags/docusaurus"}],"readingTime":0.135,"hasTruncateMarker":true,"authors":[{"name":"Gao Wei","title":"Docusaurus Core Team","url":"https://github.com/wgao19","imageURL":"https://github.com/wgao19.png","key":"gaowei","page":null}],"frontMatter":{"slug":"first-blog-post","title":"First Blog Post","authors":["gaowei"],"tags":["hola","docusaurus"]},"unlisted":false,"prevItem":{"title":"Long Blog Post","permalink":"/guides/blog/long-blog-post"}},"content":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\n\x3c!-- truncate --\x3e"}]}}')}}]);