"use strict";(self.webpackChunkdocusaurus_guides=self.webpackChunkdocusaurus_guides||[]).push([[7113],{8509:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>c,default:()=>a,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"programming/devops/kubernetes/kubernetes-api-server","title":"Kube-ApiServer","description":"\ud83d\udccc What Is the Kubernetes API Server?","source":"@site/docs/programming/devops/kubernetes/kubernetes-api-server.md","sourceDirName":"programming/devops/kubernetes","slug":"/programming/devops/kubernetes/kubernetes-api-server","permalink":"/guides/docs/programming/devops/kubernetes/kubernetes-api-server","draft":false,"unlisted":false,"editUrl":"https://github.com/talkohavy/guides/docs/programming/devops/kubernetes/kubernetes-api-server.md","tags":[],"version":"current","frontMatter":{},"sidebar":"mySidebar","previous":{"title":"- Resources","permalink":"/guides/docs/programming/devops/kubernetes/resources"},"next":{"title":"- Architecture and Concepts","permalink":"/guides/docs/programming/devops/kubernetes/architecture-and-concepts"}}');var t=n(5813),i=n(3546);const l={},c="Kube-ApiServer",d={},o=[{value:"\ud83d\udccc What Is the Kubernetes API Server?",id:"-what-is-the-kubernetes-api-server",level:2},{value:"\ud83c\udfaf Core Responsibilities",id:"-core-responsibilities",level:2},{value:"\ud83d\udd0d What Happens When You Run kubectl apply?",id:"-what-happens-when-you-run-kubectl-apply",level:2},{value:"\ud83d\udce6 1. kubectl parses the YAML",id:"-1-kubectl-parses-the-yaml",level:3},{value:"\ud83d\udd10 2. Authentication",id:"-2-authentication",level:3},{value:"\u2705 3. Authorization",id:"-3-authorization",level:3},{value:"\ud83e\uddf0 4. Admission Controllers Run",id:"-4-admission-controllers-run",level:3},{value:"\ud83d\udcd6 5. Validation &amp; Defaulting",id:"-5-validation--defaulting",level:3},{value:"\ud83e\udde0 6. Storage in etcd",id:"-6-storage-in-etcd",level:3},{value:"\ud83d\udd01 7. Controllers Start Acting",id:"-7-controllers-start-acting",level:3},{value:"\ud83d\udd12 Authentication &amp; Authorization Layers",id:"-authentication--authorization-layers",level:2},{value:"\ud83d\udd10 Authentication Methods",id:"-authentication-methods",level:3},{value:"\ud83d\udd10 Authentication Methods",id:"-authentication-methods-1",level:4},{value:"\ud83d\udd10 Authorization Modes",id:"-authorization-modes",level:4},{value:"\ud83d\udcda The Kubernetes Resource Model",id:"-the-kubernetes-resource-model",level:2},{value:"\ud83d\udcc8 Monitoring the API Server",id:"-monitoring-the-api-server",level:2},{value:"\ud83d\udd10 Security Best Practices",id:"-security-best-practices",level:2},{value:"\ud83e\uddf5 Final Summary",id:"-final-summary",level:2}];function h(e){const s={blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"kube-apiserver",children:"Kube-ApiServer"})}),"\n",(0,t.jsx)(s.h2,{id:"-what-is-the-kubernetes-api-server",children:"\ud83d\udccc What Is the Kubernetes API Server?"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.strong,{children:"Kubernetes API Server"})," (",(0,t.jsx)(s.code,{children:"kube-apiserver"}),") is the central ",(0,t.jsx)(s.strong,{children:"control plane component"})," in every Kubernetes cluster.",(0,t.jsx)(s.br,{}),"\n","It acts as the ",(0,t.jsx)(s.strong,{children:"gateway"})," through which all components, users, and tools interact with the cluster."]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:"Think of it as the front door to your Kubernetes brain."}),"\n"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"-core-responsibilities",children:"\ud83c\udfaf Core Responsibilities"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Role"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"API Frontend"})}),(0,t.jsx)(s.td,{children:"Exposes the Kubernetes API (RESTful, HTTP/JSON)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Authentication & Authorization"})}),(0,t.jsx)(s.td,{children:"Validates user identity and access rights (RBAC, ABAC, etc.)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Admission Control"})}),(0,t.jsx)(s.td,{children:"Enforces policies (e.g., resource limits, quotas, security settings)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Data Validation"})}),(0,t.jsx)(s.td,{children:"Checks schema correctness of submitted YAML/JSON"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Etcd Interaction"})}),(0,t.jsx)(s.td,{children:"Persists the cluster's state in etcd (a distributed key-value store)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Cluster State Management"})}),(0,t.jsx)(s.td,{children:"Orchestrates updates and maintains consistency across the cluster"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Serving Clients"})}),(0,t.jsxs)(s.td,{children:["Responds to ",(0,t.jsx)(s.code,{children:"kubectl"}),", Controllers, Operators, and other external clients"]})]})]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"-what-happens-when-you-run-kubectl-apply",children:"\ud83d\udd0d What Happens When You Run kubectl apply?"}),"\n",(0,t.jsx)(s.p,{children:"Let's break down the process behind:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"kubectl apply -f deployment.yaml\n"})}),"\n",(0,t.jsx)(s.h3,{id:"-1-kubectl-parses-the-yaml",children:"\ud83d\udce6 1. kubectl parses the YAML"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Validates that the file is properly formatted."}),"\n",(0,t.jsxs)(s.li,{children:["Reads resource kind (",(0,t.jsx)(s.code,{children:"Deployment"}),", ",(0,t.jsx)(s.code,{children:"Service"}),", etc.), metadata, and spec."]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"-2-authentication",children:"\ud83d\udd10 2. Authentication"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"kubectl"})," contacts the API server over HTTPS."]}),"\n",(0,t.jsxs)(s.li,{children:["Uses your ",(0,t.jsx)(s.code,{children:"kubeconfig"})," (typically located at ",(0,t.jsx)(s.code,{children:"~/.kube/config"}),") to:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Identify the ",(0,t.jsx)(s.strong,{children:"cluster endpoint"})]}),"\n",(0,t.jsxs)(s.li,{children:["Provide ",(0,t.jsx)(s.strong,{children:"credentials"})," (tokens, client certs, etc.)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"-3-authorization",children:"\u2705 3. Authorization"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["API Server checks ",(0,t.jsx)(s.strong,{children:"what you're allowed to do"})," (via RBAC or other mechanisms)."]}),"\n",(0,t.jsxs)(s.li,{children:["For example, are you allowed to ",(0,t.jsx)(s.code,{children:"create"})," a Deployment in the ",(0,t.jsx)(s.code,{children:"default"})," namespace?"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"-4-admission-controllers-run",children:"\ud83e\uddf0 4. Admission Controllers Run"}),"\n",(0,t.jsxs)(s.p,{children:["If you pass authorization, ",(0,t.jsx)(s.strong,{children:"Admission Controllers"})," kick in:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Examples:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"LimitRanger"}),": Ensures resource requests/limits."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"PodSecurityPolicy"}),": Blocks insecure specs."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"NamespaceLifecycle"}),": Prevents changes in terminating namespaces."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"-5-validation--defaulting",children:"\ud83d\udcd6 5. Validation & Defaulting"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Checks your resource ",(0,t.jsx)(s.strong,{children:"against its OpenAPI schema"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:["Adds ",(0,t.jsx)(s.strong,{children:"default fields"})," you didn't specify (e.g., ",(0,t.jsx)(s.code,{children:"restartPolicy: Always"})," for Pods)."]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"-6-storage-in-etcd",children:"\ud83e\udde0 6. Storage in etcd"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The API Server persists the resource ",(0,t.jsx)(s.strong,{children:"state"})," in ",(0,t.jsx)(s.strong,{children:"etcd"}),", the cluster's source of truth."]}),"\n",(0,t.jsx)(s.li,{children:"etcd is a distributed key-value store optimized for fast reads/writes and versioning."}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"-7-controllers-start-acting",children:"\ud83d\udd01 7. Controllers Start Acting"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Deployment controller"})," sees a new Deployment object in etcd."]}),"\n",(0,t.jsxs)(s.li,{children:["It creates a ",(0,t.jsx)(s.strong,{children:"ReplicaSet"}),", which in turn creates the desired number of ",(0,t.jsx)(s.strong,{children:"Pods"}),"."]}),"\n",(0,t.jsx)(s.li,{children:'Each controller watches for state changes and reacts to meet the "desired state".'}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"kubectl apply"})," stores a ",(0,t.jsx)(s.code,{children:"last-applied-configuration"})," annotation in the object metadata to track future diffs."]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"-authentication--authorization-layers",children:"\ud83d\udd12 Authentication & Authorization Layers"}),"\n",(0,t.jsx)(s.h3,{id:"-authentication-methods",children:"\ud83d\udd10 Authentication Methods"}),"\n",(0,t.jsx)(s.h4,{id:"-authentication-methods-1",children:"\ud83d\udd10 Authentication Methods"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"X.509 Certificates"}),"\n",(0,t.jsx)(s.li,{children:"Bearer Tokens"}),"\n",(0,t.jsx)(s.li,{children:"OpenID Connect (OIDC)"}),"\n",(0,t.jsx)(s.li,{children:"Service Accounts"}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"-authorization-modes",children:"\ud83d\udd10 Authorization Modes"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"RBAC (Role-Based Access Control) \u2705 most common"}),"\n",(0,t.jsx)(s.li,{children:"ABAC"}),"\n",(0,t.jsx)(s.li,{children:"Webhook"}),"\n",(0,t.jsx)(s.li,{children:"Node (for kubelets)"}),"\n"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"-the-kubernetes-resource-model",children:"\ud83d\udcda The Kubernetes Resource Model"}),"\n",(0,t.jsxs)(s.p,{children:["The API Server supports ",(0,t.jsx)(s.strong,{children:"hundreds of resource types"}),", grouped by ",(0,t.jsx)(s.strong,{children:"API groups"})," and versions."]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Kind"}),(0,t.jsx)(s.th,{children:"API Group"}),(0,t.jsx)(s.th,{children:"Version"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Pod"}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.code,{children:'""'})," (core group)"]}),(0,t.jsx)(s.td,{children:"v1"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Deployment"}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"apps"})}),(0,t.jsx)(s.td,{children:"v1"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Ingress"}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"networking.k8s.io"})}),(0,t.jsx)(s.td,{children:"v1"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"CustomResourceDefinition"}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"apiextensions.k8s.io"})}),(0,t.jsx)(s.td,{children:"v1"})]})]})]}),"\n",(0,t.jsx)(s.p,{children:"You can list all resources and their endpoints with:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"kubectl api-resources\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"-monitoring-the-api-server",children:"\ud83d\udcc8 Monitoring the API Server"}),"\n",(0,t.jsx)(s.p,{children:"Check logs:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"kubectl logs -n kube-system kube-apiserver-<node-name>\n"})}),"\n",(0,t.jsx)(s.p,{children:"Get the node's name using:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"k get node\n"})}),"\n",(0,t.jsx)(s.p,{children:"Use Prometheus metrics (if enabled):"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"https://<api-server-host>:port/metrics\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"-security-best-practices",children:"\ud83d\udd10 Security Best Practices"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Use ",(0,t.jsx)(s.strong,{children:"RBAC"})," to tightly control who can do what."]}),"\n",(0,t.jsxs)(s.li,{children:["Enable ",(0,t.jsx)(s.strong,{children:"audit logs"})," for sensitive actions."]}),"\n",(0,t.jsxs)(s.li,{children:["Use ",(0,t.jsx)(s.strong,{children:"API server flags"})," to restrict access (e.g., ",(0,t.jsx)(s.code,{children:"--anonymous-auth=false"}),")."]}),"\n",(0,t.jsxs)(s.li,{children:["Protect etcd (encrypt secrets at rest via ",(0,t.jsx)(s.code,{children:"EncryptionConfiguration"}),")."]}),"\n"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"-final-summary",children:"\ud83e\uddf5 Final Summary"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Role"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Entry point for all cluster actions"}),(0,t.jsx)(s.td,{children:"Exposes the REST API for all Kubernetes resources"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Central orchestration brain"}),(0,t.jsx)(s.td,{children:"Talks to etcd, triggers controllers"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Enforces access & policy"}),(0,t.jsx)(s.td,{children:"Authn, Authz, and Admission Controllers"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Supports declarative workflows"}),(0,t.jsxs)(s.td,{children:["Powers ",(0,t.jsx)(s.code,{children:"kubectl apply"}),", CI/CD pipelines"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Critical for cluster availability"}),(0,t.jsx)(s.td,{children:"If it\u2019s down, no changes can be made"})]})]})]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"The API Server is the heart of Kubernetes"}),", and understanding how it works is crucial to operating, securing, and automating any cluster."]})]})}function a(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},3546:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>c});var r=n(9729);const t={},i=r.createContext(t);function l(e){const s=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);