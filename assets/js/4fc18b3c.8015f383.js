"use strict";(self.webpackChunkdocusaurus_guides=self.webpackChunkdocusaurus_guides||[]).push([[8153],{1194:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>o,frontMatter:()=>t,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"programming/devops/helm/maintain-a-chart","title":"Maintain a chart","description":"1. Create a chart","source":"@site/docs/programming/devops/helm/maintain-a-chart.md","sourceDirName":"programming/devops/helm","slug":"/programming/devops/helm/maintain-a-chart","permalink":"/guides/docs/programming/devops/helm/maintain-a-chart","draft":false,"unlisted":false,"editUrl":"https://github.com/talkohavy/guides/docs/programming/devops/helm/maintain-a-chart.md","tags":[],"version":"current","frontMatter":{},"sidebar":"mySidebar","previous":{"title":"- Helm Upgrade: Deep Dive","permalink":"/guides/docs/programming/devops/helm/helm-upgrade-deep-dive"},"next":{"title":"- Helm Strategies","permalink":"/guides/docs/programming/devops/helm/helm-strategies"}}');var i=r(5813),s=r(3546);const t={},l="Maintain a chart",d={},c=[{value:"1. Create a chart",id:"1-create-a-chart",level:2},{value:"2. Chart.yaml",id:"2-chartyaml",level:2},{value:"\u2022 Description",id:"-description",level:3},{value:"\u2022 Purpose of Chart.yaml",id:"-purpose-of-chartyaml",level:3},{value:"\u2022 Common fields in Chart.yaml",id:"-common-fields-in-chartyaml",level:3},{value:"\u2022 Why it matters",id:"-why-it-matters",level:3},{value:"\u2022 More optional keys",id:"-more-optional-keys",level:3},{value:"3. helpers",id:"3-helpers",level:2},{value:"4. Templating Syntax &amp; tricks",id:"4-templating-syntax--tricks",level:2},{value:"- A. if statement",id:"--a-if-statement",level:3},{value:"- B. <code>include</code>",id:"--b-include",level:3},{value:"5. helm package",id:"5-helm-package",level:2}];function h(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"maintain-a-chart",children:"Maintain a chart"})}),"\n",(0,i.jsx)(n.h2,{id:"1-create-a-chart",children:"1. Create a chart"}),"\n",(0,i.jsx)(n.p,{children:"use the command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"`helm create CHART_NAME`\n"})}),"\n",(0,i.jsxs)(n.p,{children:["When you run ",(0,i.jsx)(n.code,{children:"helm create"}),", a folder will be created with the following structure:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Chart.yaml"}),"\n",(0,i.jsx)(n.li,{children:"values.yaml"}),"\n",(0,i.jsx)(n.li,{children:"templates/"}),"\n",(0,i.jsx)(n.li,{children:"charts/"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"2-chartyaml",children:"2. Chart.yaml"}),"\n",(0,i.jsx)(n.h3,{id:"-description",children:"\u2022 Description"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"Chart.yaml"})," for helm is much like what the ",(0,i.jsx)(n.strong,{children:"package.json"})," is for npm."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"Chart.yaml"})," is a required metadata file for every Helm chart. It serves as the manifest that defines the chart itself."]}),"\n",(0,i.jsx)(n.h3,{id:"-purpose-of-chartyaml",children:"\u2022 Purpose of Chart.yaml"}),"\n",(0,i.jsx)(n.p,{children:"It contains key metadata about your chart so that Helm and other tools know:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"What the chart is"}),"\n",(0,i.jsx)(n.li,{children:"What version it is"}),"\n",(0,i.jsx)(n.li,{children:"What it depends on"}),"\n",(0,i.jsx)(n.li,{children:"What Kubernetes resources it describes"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-common-fields-in-chartyaml",children:"\u2022 Common fields in Chart.yaml"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yml",children:'apiVersion: v2\nname: my-app\ndescription: A Helm chart for Kubernetes\ntype: application\nversion: 0.1.0\nappVersion: "1.16.0"\n'})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Field"}),(0,i.jsx)(n.th,{children:"Purpose"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"apiVersion"}),(0,i.jsx)(n.td,{children:"(required) Chart API version (v2 for Helm 3)."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"name"}),(0,i.jsx)(n.td,{children:"(required) Name of the chart."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"version"}),(0,i.jsx)(n.td,{children:"(required) Version of the chart itself. Helm uses this for upgrades and rollbacks."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"description"}),(0,i.jsx)(n.td,{children:"Short human-readable summary."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"type"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"application"})," (default) or ",(0,i.jsx)(n.code,{children:"library"}),"."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"appVersion"}),(0,i.jsx)(n.td,{children:"Version of the actual app being deployed (informational). i.e, MongoDB 8.0"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"-why-it-matters",children:"\u2022 Why it matters"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Helm installs and upgrades charts based on ",(0,i.jsx)(n.code,{children:"version"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dependencies"})," can be listed here, allowing Helm to pull in subcharts automatically."]}),"\n",(0,i.jsxs)(n.li,{children:["Tools like ",(0,i.jsx)(n.code,{children:"helm repo"})," and ",(0,i.jsx)(n.code,{children:"helm package"})," read this file to index and distribute your chart."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-more-optional-keys",children:"\u2022 More optional keys"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["You can specify an ",(0,i.jsx)(n.code,{children:"icon"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["You can specify ",(0,i.jsx)(n.code,{children:"keywords"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["You can specify ",(0,i.jsx)(n.code,{children:"home"}),", which is the home url of your project."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"maintainers"}),": list of people maintaining this chart."]}),"\n"]}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.h2,{id:"3-helpers",children:"3. helpers"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"_helpers.tpl\n"})}),"\n",(0,i.jsxs)(n.p,{children:["It starts with an underscore (",(0,i.jsx)(n.code,{children:"_"}),") so that it would always come on top.\nThe ",(0,i.jsx)(n.code,{children:"tpl"})," stands for template."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"_helpers.tpl"})," contains methods that can be used in a ",(0,i.jsx)(n.code,{children:".yaml"})," file. If you open it you can see a bunch of functions defined."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yml",children:'{{/*\nCreate a default fully qualified app name.\nWe truncate at 63 chars because some Kubernetes name fields are limited to this (by the DNS naming spec).\nIf release name contains chart name it will be used as a full name.\n*/}}\n{{- define "hello.fullname" -}}\n{{- if .Values.fullnameOverride }}\n{{- .Values.fullnameOverride | trunc 63 | trimSuffix "-" }}\n{{- else }}\n{{- $name := default .Chart.Name .Values.nameOverride }}\n{{- if contains $name .Release.Name }}\n{{- .Release.Name | trunc 63 | trimSuffix "-" }}\n{{- else }}\n{{- printf "%s-%s" .Release.Name $name | trunc 63 | trimSuffix "-" }}\n{{- end }}\n{{- end }}\n{{- end }}\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yml",children:'{{/*\nCreate chart name and version as used by the chart label.\n*/}}\n{{- define "hello.chart" -}}\n{{- printf "%s-%s" .Chart.Name .Chart.Version | replace "+" "_" | trunc 63 | trimSuffix "-" }}\n{{- end }}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"4-templating-syntax--tricks",children:"4. Templating Syntax & tricks"}),"\n",(0,i.jsx)(n.h3,{id:"--a-if-statement",children:"- A. if statement"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"{{- if .Values.ingress.enabled}}\n# something here...\n{{- end }}\n"})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsxs)(n.h3,{id:"--b-include",children:["- B. ",(0,i.jsx)(n.code,{children:"include"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"include"})," is a way to invoke a helper function, defined in one of your ",(0,i.jsx)(n.code,{children:".tpl"})," files.",(0,i.jsx)(n.br,{}),"\n","You can pass all parameters to it like so: ",(0,i.jsx)(n.code,{children:"."})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"{{ include SOME.FUNC.NAME}}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"5-helm-package",children:"5. helm package"}),"\n",(0,i.jsxs)(n.p,{children:["When it's time to package the chart up for distribution, you can run the ",(0,i.jsx)(n.code,{children:"helm package"})," command:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm package path/to/chart-root\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The output of this command is a file named: ",(0,i.jsx)(n.code,{children:"CHART_NAME-0.1.0.tgz"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Charts that are packaged can be loaded into chart repositories. See the documentation for ",(0,i.jsx)(n.a,{href:"https://helm.sh/docs/topics/chart_repository/",children:"Helm chart repositories"})," for more details."]})]})}function o(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},3546:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>l});var a=r(9729);const i={},s=a.createContext(i);function t(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);