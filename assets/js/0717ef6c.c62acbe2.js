"use strict";(self.webpackChunkdocusaurus_guides=self.webpackChunkdocusaurus_guides||[]).push([[2616],{3147:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>h,contentTitle:()=>o,default:()=>a,frontMatter:()=>r,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"knowledge/oauth2","title":"Everything about OAuth 2.0","description":"1. what is OAuth 2.0?","source":"@site/docs/knowledge/oauth2.md","sourceDirName":"knowledge","slug":"/knowledge/oauth2","permalink":"/guides/docs/knowledge/oauth2","draft":false,"unlisted":false,"editUrl":"https://github.com/talkohavy/guides/docs/knowledge/oauth2.md","tags":[],"version":"current","frontMatter":{},"sidebar":"mySidebar","previous":{"title":"- Post vs Get Login","permalink":"/guides/docs/knowledge/post-vs-get-login"},"next":{"title":"- SOLID Principles","permalink":"/guides/docs/knowledge/solid"}}');var i=s(5813),t=s(3546);const r={},o="Everything about OAuth 2.0",h={},d=[{value:"1. what is OAuth 2.0?",id:"1-what-is-oauth-20",level:2},{value:"2. What problem OAuth 2.0 actually solves?",id:"2-what-problem-oauth-20-actually-solves",level:2},{value:"3. The 4 core roles",id:"3-the-4-core-roles",level:2},{value:"1\ufe0f\u20e3 Resource Owner",id:"1\ufe0f\u20e3-resource-owner",level:3},{value:"2\ufe0f\u20e3 Client",id:"2\ufe0f\u20e3-client",level:3},{value:"3\ufe0f\u20e3 Authorization Server",id:"3\ufe0f\u20e3-authorization-server",level:3},{value:"4\ufe0f\u20e3 Resource Server",id:"4\ufe0f\u20e3-resource-server",level:3},{value:"4. What OAuth2 is <strong>NOT</strong>",id:"4-what-oauth2-is-not",level:2},{value:"5. So what does OAuth2 actually define?",id:"5-so-what-does-oauth2-actually-define",level:2},{value:"The central idea: tokens",id:"the-central-idea-tokens",level:2},{value:"OAuth2 is a framework, not a protocol",id:"oauth2-is-a-framework-not-a-protocol",level:2},{value:"Common OAuth2 grant types (high-level)",id:"common-oauth2-grant-types-high-level",level:2},{value:"Why OAuth2 often <em>looks</em> like login",id:"why-oauth2-often-looks-like-login",level:2},{value:"Minimal mental model (keep this)",id:"minimal-mental-model-keep-this",level:2}];function c(e){const n={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"everything-about-oauth-20",children:"Everything about OAuth 2.0"})}),"\n",(0,i.jsx)(n.h2,{id:"1-what-is-oauth-20",children:"1. what is OAuth 2.0?"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"OAuth 2.0 is an authorization framework that lets a user grant a third-party application limited access to a resource, without sharing their credentials."})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Key words:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"authorization"})," (not authentication)"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"limited access"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"no credential sharing"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"If a definition doesn\u2019t include those ideas, it\u2019s incomplete."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"2-what-problem-oauth-20-actually-solves",children:"2. What problem OAuth 2.0 actually solves?"}),"\n",(0,i.jsx)(n.p,{children:"Before OAuth:"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u201cHey Google, give this random app my password so it can read my emails.\u201d"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"That\u2019s obviously terrible."}),"\n",(0,i.jsx)(n.p,{children:"OAuth2 solves:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Delegated access"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Scoped access"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Revocable access"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Without:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"giving away your password"}),"\n",(0,i.jsxs)(n.li,{children:["letting the app do ",(0,i.jsx)(n.em,{children:"everything"})]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"3-the-4-core-roles",children:"3. The 4 core roles"}),"\n",(0,i.jsxs)(n.p,{children:["OAuth2 is easiest to define by its ",(0,i.jsx)(n.strong,{children:"actors"}),":"]}),"\n",(0,i.jsx)(n.h3,{id:"1\ufe0f\u20e3-resource-owner",children:"1\ufe0f\u20e3 Resource Owner"}),"\n",(0,i.jsx)(n.p,{children:"\ud83d\udc49 The user"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u201cI own the data\u201d"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"2\ufe0f\u20e3-client",children:"2\ufe0f\u20e3 Client"}),"\n",(0,i.jsx)(n.p,{children:"\ud83d\udc49 The app requesting access"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u201cI want to access your data on your behalf\u201d"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Examples:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"GitHub OAuth app"}),"\n",(0,i.jsx)(n.li,{children:"Google login button"}),"\n",(0,i.jsx)(n.li,{children:"A CLI tool"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"3\ufe0f\u20e3-authorization-server",children:"3\ufe0f\u20e3 Authorization Server"}),"\n",(0,i.jsx)(n.p,{children:"\ud83d\udc49 Issues tokens"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u201cI authenticate users and issue access\u201d"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Examples:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Google Accounts"}),"\n",(0,i.jsx)(n.li,{children:"GitHub OAuth"}),"\n",(0,i.jsx)(n.li,{children:"Auth0"}),"\n",(0,i.jsx)(n.li,{children:"Keycloak"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"4\ufe0f\u20e3-resource-server",children:"4\ufe0f\u20e3 Resource Server"}),"\n",(0,i.jsx)(n.p,{children:"\ud83d\udc49 Hosts protected APIs"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u201cI accept tokens and serve data\u201d"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Examples:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Google Drive API"}),"\n",(0,i.jsx)(n.li,{children:"GitHub API"}),"\n",(0,i.jsx)(n.li,{children:"Your backend"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u26a0\ufe0f Authorization Server and Resource Server ",(0,i.jsx)(n.strong,{children:"may be the same system"}),", but conceptually they are different."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"4-what-oauth2-is-not",children:["4. What OAuth2 is ",(0,i.jsx)(n.strong,{children:"NOT"})]}),"\n",(0,i.jsx)(n.p,{children:"This clears up most confusion."}),"\n",(0,i.jsxs)(n.p,{children:["\u274c OAuth2 is ",(0,i.jsx)(n.strong,{children:"not"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"a login system"}),"\n",(0,i.jsx)(n.li,{children:"an authentication protocol"}),"\n",(0,i.jsx)(n.li,{children:"a token format"}),"\n",(0,i.jsx)(n.li,{children:"JWT"}),"\n",(0,i.jsx)(n.li,{children:"a session replacement"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["OAuth2 ",(0,i.jsx)(n.strong,{children:"does not tell you who the user is"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"It only says:"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u201cThis client is allowed to do X on resource Y.\u201d"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"5-so-what-does-oauth2-actually-define",children:"5. So what does OAuth2 actually define?"}),"\n",(0,i.jsx)(n.p,{children:"OAuth2 defines:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"How a client asks for permission"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"How a user approves that request"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"How the client gets a token"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"How the token is used to access resources"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["It does ",(0,i.jsx)(n.strong,{children:"not"})," define:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"how users log in"}),"\n",(0,i.jsx)(n.li,{children:"what tokens look like"}),"\n",(0,i.jsx)(n.li,{children:"how tokens are validated internally"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"the-central-idea-tokens",children:"The central idea: tokens"}),"\n",(0,i.jsxs)(n.p,{children:["OAuth2 introduces ",(0,i.jsx)(n.strong,{children:"access tokens"}),":"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["A token represents ",(0,i.jsx)(n.strong,{children:"delegated authorization"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Properties:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Limited scope"}),"\n",(0,i.jsx)(n.li,{children:"Limited lifetime"}),"\n",(0,i.jsx)(n.li,{children:"Revocable"}),"\n",(0,i.jsx)(n.li,{children:"Not a password"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The token says:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"Client X may perform actions A, B, C on behalf of User U\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"oauth2-is-a-framework-not-a-protocol",children:"OAuth2 is a framework, not a protocol"}),"\n",(0,i.jsx)(n.p,{children:"This is subtle but important."}),"\n",(0,i.jsx)(n.p,{children:"OAuth2:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["defines ",(0,i.jsx)(n.strong,{children:"flows"})," (called ",(0,i.jsx)(n.em,{children:"grant types"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["defines ",(0,i.jsx)(n.strong,{children:"roles and endpoints"})]}),"\n",(0,i.jsx)(n.li,{children:"leaves many details intentionally open"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"That\u2019s why:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"implementations vary"}),"\n",(0,i.jsx)(n.li,{children:"security pitfalls exist"}),"\n",(0,i.jsxs)(n.li,{children:["standards like ",(0,i.jsx)(n.strong,{children:"OpenID Connect"})," were added later"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"common-oauth2-grant-types-high-level",children:"Common OAuth2 grant types (high-level)"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Grant"}),(0,i.jsx)(n.th,{children:"Used for"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Authorization Code"}),(0,i.jsx)(n.td,{children:"Web apps, SPAs, mobile"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Client Credentials"}),(0,i.jsx)(n.td,{children:"Machine \u2192 machine"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Device Code"}),(0,i.jsx)(n.td,{children:"TVs, CLIs"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Refresh Token"}),(0,i.jsx)(n.td,{children:"Long-lived access"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"(We\u2019ll zoom into these later.)"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"why-oauth2-often-looks-like-login",children:["Why OAuth2 often ",(0,i.jsx)(n.em,{children:"looks"})," like login"]}),"\n",(0,i.jsx)(n.p,{children:"Because people misuse it for authentication."}),"\n",(0,i.jsx)(n.p,{children:"Example:"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u201cLogin with Google\u201d"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"What\u2019s really happening:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"OAuth2 grants access to Google APIs"}),"\n",(0,i.jsxs)(n.li,{children:["Plus ",(0,i.jsx)(n.strong,{children:"OpenID Connect"})," adds identity info"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["OAuth2 alone does ",(0,i.jsx)(n.strong,{children:"not"})," say:"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u201cThis is user 123\u201d"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"That\u2019s OIDC\u2019s job."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"minimal-mental-model-keep-this",children:"Minimal mental model (keep this)"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["OAuth2 answers:\n",(0,i.jsx)(n.strong,{children:"\u201cCan this app do this action on that resource?\u201d"})]}),"\n",(0,i.jsxs)(n.p,{children:["It does ",(0,i.jsx)(n.strong,{children:"not"})," answer:\n",(0,i.jsx)(n.strong,{children:"\u201cWho is the user?\u201d"})]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},3546:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>o});var l=s(9729);const i={},t=l.createContext(i);function r(e){const n=l.useContext(t);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),l.createElement(t.Provider,{value:n},e.children)}}}]);